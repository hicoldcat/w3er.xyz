---
title: æ‰‹æŠŠæ‰‹åˆ†æ­¥æ•™ç¨‹â€”â€”æ„å»ºå’Œéƒ¨ç½²ä¸€ä¸ªæœ‰è¶£å’Œç°ä»£çš„æ­è®ªè¯æ”¶é›†Web3åŒºå—é“¾dApp
description: null
author: æç•™ç™½
weight: 0
date: 2022-09-17T01:13:33.804Z
lastmod: 2022-09-17T01:57:56.894Z
tags: []
categories:
  - åŒºå—é“¾
featuredImage: https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220917091345.png
---

åœ¨æœ¬ Web3 æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªåŠŸèƒ½é½å…¨çš„åŒºå—é“¾web3åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬å°†ä»æ„å»ºåŒºå—é“¾åº”ç”¨ç¨‹åºçš„åŸºç¡€å¼€å§‹ï¼Œæœ€åï¼Œæˆ‘ä»¬å°†ä¸Šçº¿æˆ‘ä»¬çš„web3åº”ç”¨ç¨‹åºä¾›æ‰€æœ‰äººä½¿ç”¨ã€‚

## æˆ‘ä»¬è¦å»ºé€ ä»€ä¹ˆï¼Ÿ

æˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªåä¸º[ğŸ§€ Pick Up Linesçš„å»](https://www.pickuplines.art/)**ä¸­å¿ƒåŒ–åº”ç”¨ç¨‹åºï¼ˆdAppï¼‰**ã€‚é¡¾åæ€ä¹‰ï¼Œæˆ‘ä»¬çš„ç”¨æˆ·å°†èƒ½å¤Ÿå‘é€ä¸€äº›å¥½çš„è€å¼æ­è®ªå°è¯ï¼Œå¹¶æœ‰æœºä¼šèµ¢å¾—ä»¥å¤ªåŠä½œä¸ºå¥–åŠ±

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/zarlX1XZp.gif)

## å…ˆå†³æ¡ä»¶

- **React**åˆçº§åˆ°ä¸­çº§çŸ¥è¯†
- å¯¹**Solidity**æ™ºèƒ½åˆçº¦æœ‰ä¸€å®šäº†è§£
- **å¯¹åŒºå—é“¾ç¼–ç¨‹**çš„åŸºæœ¬äº†è§£

## æˆ‘ä»¬éœ€è¦çš„å·¥å…·

å·¥ä½œå˜æˆäº†ä½¿ç”¨æ­£ç¡®çš„å·¥å…·ï¼Œå¯¹å§ï¼Ÿå¹¸è¿çš„æ˜¯ï¼Œweb3 æœ‰å¾ˆå¤šå·¥å…·å¯ä»¥ç”¨æ¥å®ç°è‡­åæ˜­è‘—çš„**WAGMI** ğŸ§˜

1. Visual Studio Code æˆ–ä»»ä½•æ–‡æœ¬ç¼–è¾‘å™¨
2. ç”¨äºä»¥å¤ªåŠå¼€å‘çš„å®‰å…¨å¸½
3. Metamask ä½œä¸ºåŠ å¯†é’±åŒ…
4. Vercel å’Œ Alchemy ä½œä¸ºæ‰˜ç®¡å¹³å°

## è®©æˆ‘ä»¬å¼€å§‹ï¼

ç°åœ¨ï¼Œæˆ‘ä»¬å¯¹æœ€ç»ˆçš„åº”ç”¨ç¨‹åºå’Œæˆ‘ä»¬å°†è¦ä½¿ç”¨çš„å·¥å…·æœ‰äº†ä¸€äº›äº†è§£ï¼Œè®©æˆ‘ä»¬å¼€å§‹ç¼–å†™ä»£ç å§ï¼

é¦–å…ˆï¼Œæˆ‘ä»¬å°†ç¼–å†™åŒºå—é“¾åº”ç”¨ç¨‹åºçš„**æ™ºèƒ½åˆçº¦**ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†æ„å»ºæˆ‘ä»¬çš„**React åº”ç”¨ç¨‹åº**ï¼Œæœ€åï¼Œå°†è¿™ä¸¤ä¸ªä¸œè¥¿è¿æ¥èµ·æ¥ä»¥æ‹¥æœ‰ä¸€ä¸ªæˆç†Ÿçš„ web3 åº”ç”¨ç¨‹åºã€‚

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/sCg_8VCxs.gif)

## ç”¨ Solidity ç¼–å†™æˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦ï¼š

### 1. è¿è¡Œæˆ‘ä»¬çš„æœ¬åœ°ä»¥å¤ªåŠç½‘ç»œ

æˆ‘ä»¬éœ€è¦å¯åŠ¨ä¸€ä¸ªæœ¬åœ°ä»¥å¤ªåŠç½‘ç»œã€‚æœ¬åœ°ä»¥å¤ªåŠç½‘ç»œæ˜¯ä¸“é—¨åœ¨æ‚¨çš„æœ¬åœ°æœºå™¨ä¸Šè¿è¡Œçš„åŒºå—é“¾ç½‘ç»œã€‚æˆ‘ä»¬å°†åœ¨æ„å»ºåº”ç”¨ç¨‹åºæ—¶ä½¿ç”¨å®ƒè¿›è¡Œæµ‹è¯•ï¼Œå› ä¸ºå®ƒä¸ºæˆ‘ä»¬æä¾›äº†æ‰€æœ‰åŒºå—é“¾åŠŸèƒ½ï¼Œè€Œæ— éœ€ä½¿ç”¨*çœŸæ­£çš„*åŠ å¯†è´§å¸ã€‚

åœ¨è¿™ä¸ª web3 æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨[Hardhat](https://hardhat.org/)ã€‚ç”±äºæˆ‘ä»¬éœ€è¦åœ¨å¯åŠ¨ä¹‹å‰åœ¨æœ¬åœ°æµ‹è¯•æˆ‘ä»¬çš„åŒºå—é“¾åº”ç”¨ç¨‹åºï¼Œå› æ­¤æˆ‘ä»¬å°†ä½¿ç”¨å‡ ETH å’Œå‡æµ‹è¯•å¸æˆ·é€šè¿‡ Hardhat æµ‹è¯•æˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œå®ƒå°†æœ‰åŠ©äºåœ¨æˆ‘ä»¬çš„æœ¬åœ°åŒºå—é“¾ä¸Šç¼–è¯‘æˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦ã€‚

ç°åœ¨ï¼Œå‰å¾€ç»ˆç«¯å¹¶ç§»åŠ¨åˆ°æ‚¨æƒ³è¦çš„ç›®å½•ã€‚åœ¨é‚£é‡Œï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```shell
mkdir pickup-lines
cd pickup-lines
npm init -y
npm install --save-dev hardhat

```

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬è¿è¡Œä¸€ä¸ªç¤ºä¾‹é¡¹ç›®ï¼š

```shell
/*To create our Hardhat project*/
npx hardhat
```

è¿è¡Œé¡¹ç›®ï¼š

```shell
/*To compile our contracts*/
npx hardhat compile
```

æµ‹è¯•é¡¹ç›®ï¼š

```shell
/*To run our tests*/
npx hardhat test

```

> ä¸Šé¢çš„ä»£ç è®¾ç½®äº†ä¸€ä¸ªå‡†ç³»ç»Ÿ Hardhat é¡¹ç›®ã€‚æ²¡æœ‰æ’ä»¶ï¼Œå®ƒå…è®¸æ‚¨åˆ›å»ºè‡ªå·±çš„ä»»åŠ¡ã€ç¼–è¯‘æ‚¨çš„ Solidity ä»£ç å¹¶è¿è¡Œæ‚¨çš„æµ‹è¯•ã€‚åŸºæœ¬ä¸Šï¼Œæ‚¨æ­£åœ¨æœ¬åœ°ç¯å¢ƒä¸­åˆ›å»ºåŒºå—é“¾ç½‘ç»œ

ä½ ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„ä¸œè¥¿ï¼š

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220917092720.png)

### 2. åˆ›å»ºæˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦

ç°åœ¨ï¼Œè®©æˆ‘ä»¬åœ¨`Contracts`ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª`PickupLines.sol`æ–‡ä»¶ã€‚

> æˆ‘ä»¬éœ€è¦éµå¾ªä¸¥æ ¼çš„æ–‡ä»¶å¤¹ç»“æ„ã€‚è¿™éå¸¸é‡è¦ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯åœ¨ Hardhat ä¹‹ä¸Šæ„å»ºçš„ï¼Œæˆ‘ä»¬çš„`/contracts` , `/scripts`å’Œ`/test` çš„é»˜è®¤è·¯å¾„æ˜¯é¢„å®šä¹‰çš„ã€‚ä¸éµå¾ªæ­¤ç»“æ„å°†å¯¼è‡´æˆ‘ä»¬çš„Hardhatä»»åŠ¡å¤±è´¥ã€‚è¦å°å¿ƒï¼

```solidity
/*Use a license depending on your project.*/
// SPDX-License-Identifier: UNLICENSED

/*Code is written for Solidity version 0.4.16, or a newer version*/
pragma solidity ^0.8.0;

/*Built-in Hardhat interactive JavaScript console*/
import "hardhat/console.sol";

/*Main Solidity Contract*/
contract PickupLines {
   /*Constructor function for our contract*/
    constructor() {
        console.log("I am the Cheesy PickUp Lines' smart contract.");
    }
}
```

### 3. åœ¨æœ¬åœ°è¿è¡Œæˆ‘ä»¬çš„åˆçº¦

ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè„šæœ¬æ¥è¿è¡Œæˆ‘ä»¬åˆšåˆšæ„å»ºçš„æ™ºèƒ½åˆçº¦ã€‚è¿™å°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿåœ¨æˆ‘ä»¬çš„æœ¬åœ°åŒºå—é“¾ä¸Šå¯¹å…¶è¿›è¡Œæµ‹è¯•ã€‚

è¿›å…¥`scripts`æ–‡ä»¶å¤¹å¹¶åˆ›å»ºä¸€ä¸ª`run.js`æ–‡ä»¶. åœ¨`run.js`æ–‡ä»¶ä¸­ï¼Œè¾“å…¥ä»¥ä¸‹ä»£ç ï¼š

```js
/*The `main` function to run contract locally for an instance.*/
const main = async () => {
  /*Helper function to get the contract `PickupLines`*/
  const contracts = await hre.ethers.getContractFactory("PickupLines"); 

  /*Deploying the contract for an 'instance'*/
  const contract = await contracts.deploy();
  await contract.deployed();

  /*Address of the deployed contract.*/
  console.log("Contract deployed to:", contract.address);
};

/*A try-catch block for our `main` function*/
const runMain = async () => {
  try {
    await main();
    process.exit(0); // exit Node process without error
  } catch (error) {
    console.log(error);
    process.exit(1); // exit Node process while indicating 'Uncaught Fatal Exception' error
  }
};

/*Running the `runMain` function.*/
runMain();

```

è®©æˆ‘ä»¬è¿è¡Œæˆ‘ä»¬åˆšåˆšä»ç»ˆç«¯åˆ›å»ºçš„`run.js`æ–‡ä»¶ï¼š

```js
/*To run the `run.js` file.*/
npx hardhat run scripts/run.js
```

æ‚¨å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åœ¨`constructor()`æ–¹æ³•ä¸­è¾“å…¥çš„`console.log`ä¿¡æ¯ã€‚åœ¨é‚£é‡Œï¼Œä½ ä¹Ÿä¼šçœ‹åˆ°åˆçº¦åœ°å€

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220917093226.png)

### 4. å®Œæˆæ™ºèƒ½åˆçº¦é€»è¾‘

ç°åœ¨ï¼Œè®©æˆ‘ä»¬çš„åˆåŒæ›´ä¸°å¯Œä¸€ç‚¹ã€‚

æˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿè®©æŸäººå‘æˆ‘ä»¬å‘é€æ­è®ªï¼Œç„¶åå°†è¯¥æ­è®ªå­˜å‚¨åœ¨åŒºå—é“¾ä¸­ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™æ ·ä»»ä½•äººéƒ½å¯ä»¥ç»™æˆ‘ä»¬å‘é€æ­è®ªã€‚

åœ¨`Contracts` æ–‡ä»¶å¤¹ä¸‹çš„`PickupLines.sol`æ–‡ä»¶ä¸­ï¼Œè¾“å…¥ä»¥ä¸‹ä»£ç ï¼š

```solidity
contract PickUpLines {
    /*Solidity event, that fires when a new line is submitted.*/
    event NewPickUpLine(address indexed from, uint256 timestamp, string line);

    /*Data members*/
    uint256 private seed; /*Seed data*/
    uint256 totalLines; /*Total lines data*/
    mapping(address => bool) hasWrote; /*Map of all addresses with a line submitted*/

    /*A composite data member for a pick up line*/
    struct PickUpLine {
        address writer;
        string line;
        uint256 timestamp;
    }
    /*Array of all pick up lines submitted.*/
    PickUpLine[] pickuplines;

    constructor() payable {
      console.log("I am the Cheesy PickUp Lines' smart contract!");
    }

    /*Function for adding a new line to the contract.*/
    function newLine(string memory _line) public {

        /*Adding a new Pickup Line to our blockchain.*/
        totalLines += 1;
        pickuplines.push(PickUpLine(msg.sender, _line, block.timestamp));
        hasWrote[msg.sender] = true;
        emit NewPickUpLine(msg.sender, block.timestamp, _line);
    }

    /*Function to get all the lines submitted to the contract.*/
    function getTotalLines() public view returns (uint256) {
        console.log("We have %s total PickUpLines.", totalLines);
        return totalLines;
    }
}
```

æ‰€ä»¥ï¼Œè¿™å°±æ˜¯ç”¨ Solidity ç¼–å†™å‡½æ•°çš„æ–¹å¼ã€‚

æˆ‘ä»¬è¿˜æ·»åŠ äº†ä¸€ä¸ªè‡ªåŠ¨åˆå§‹åŒ–ä¸º 0 çš„å˜é‡`totalLines`ã€‚è¿™ä¸ªå˜é‡ä¹‹æ‰€ä»¥ç‰¹æ®Šï¼Œæ˜¯å› ä¸ºå®ƒè¢«ç§°ä¸º*çŠ¶æ€å˜é‡*ï¼Œå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ï¼Œå› ä¸ºå®ƒæ°¸ä¹…å­˜å‚¨åœ¨æˆ‘ä»¬çš„åˆçº¦å­˜å‚¨ä¸­ã€‚

### 5. éƒ¨ç½²æ™ºèƒ½åˆçº¦

ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä»æœ¬åœ°åŒºå—é“¾å‡çº§åˆ°å…¨çƒå¯è®¿é—®çš„åŒºå—é“¾ã€‚

è¯·æŒ‰ç…§ä»¥ä¸‹ 4 ä¸ªæ­¥éª¤æ“ä½œï¼š

#### 1. è®©æˆ‘ä»¬åœ¨`scripts`æ–‡ä»¶å¤¹å†…åˆ›å»ºä¸€ä¸ªåä¸ºçš„`deploy.js`æ–‡ä»¶ã€‚åœ¨æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„`deploy.js`æ–‡ä»¶ä¸­è¾“å…¥ä¸‹é¢ç»™å‡ºçš„ä»£ç ã€‚

```js
   /*The `main` function to deploy contract locally*/
   const main = async () => {
   /*Getting deployer's address.*/
  const [deployer] = await hre.ethers.getSigners(); 

  /*Getting deployer's ETH balance*/
  const accountBalance = await deployer.getBalance();

  /*Logging the Deployer's address and the balance.*/
  console.log("Deploying contracts with account: ", deployer.address);
  console.log("Account balance: ", accountBalance.toString());

  /*Deploying the contract.*/
  const contracts = await hre.ethers.getContractFactory("PickupLines");
  const contract = await contracts.deploy();
  await contract.deployed();

  /*Logging the address of the deployed contract.*/
  console.log("PickupLines address: ", contract.address);
};

/*A try-catch block for our `main` function*/
const runMain = async () => {
  try {
    await main();
    process.exit(0);
  } catch (error) {
    console.log(error);
    process.exit(1);
  }
};

/*Running the `runMain` function.*/
runMain();

```

#### 2. æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªåä¸º**Alchemy**çš„å¹³å°ã€‚[åœ¨æ­¤æ³¨å†Œ](https://www.alchemy.com/)ã€‚

æˆ‘ä»¬å°†ä½¿ç”¨ Alchemy åœ¨æµ‹è¯•ç½‘ä¸Šéƒ¨ç½²æˆ‘ä»¬çš„*åˆçº¦*ã€‚è¿™æ˜¯å› ä¸ºå¦‚æœæˆ‘ä»¬ä½¿ç”¨*ä»¥å¤ªåŠä¸»ç½‘*ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”ç”¨ç¨‹åºä¸Šçš„æ¯ä¸ª**æ“ä½œ/äº¤æ˜“**éƒ½å°†å…·æœ‰çœŸæ­£çš„è´§å¸ä»·å€¼ã€‚åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå®Œå…¨å¼€å‘ä¾›å…¬ä¼—ä½¿ç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸æƒ³è¿™æ ·åšã€‚ç›®å‰ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨æµ‹è¯•æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚

é€šè¿‡æµ‹è¯•ç½‘ï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿäº«å—åŒºå—é“¾çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå°½ç®¡ä½¿ç”¨çš„æ˜¯*å‡*åŠ å¯†è´§å¸ã€‚[ä½ å¯ä»¥åœ¨è¿™é‡Œ](https://rinkebyfaucet.com/)å¾—åˆ°ä¸€äº›å‡çš„**ETH**.

#### 3. è¿™æ˜¯éƒ¨ç½²çš„æœ€åä¸€éƒ¨åˆ†ã€‚é€šè¿‡è¾“å…¥ä»¥ä¸‹ä»£ç å¯¹`hardhat.config.js`æ–‡ä»¶è¿›è¡Œæ›´æ”¹ï¼š

```js
 //Find YOUR_ALCHEMY_API_URL in the alchemy dashboard.
require("@nomiclabs/hardhat-waffle");

module.exports = {
  solidity: "0.8.0",
  networks: {
    rinkeby: {
      url: "YOUR_ALCHEMY_API_URL",
      accounts: ["YOUR_WALLET_ACCOUNT_KEY"]
    },
  },
};

```

> **æ³¨æ„ï¼šè®¿é—®æ‚¨çš„ç§é’¥å¯ä»¥é€šè¿‡æ‰“å¼€[MetaMask](https://www.metamask.io/)ï¼Œå°†ç½‘ç»œæ›´æ”¹ä¸ºâ€œRinkeby æµ‹è¯•ç½‘ç»œâ€ï¼Œç„¶åå•å‡»ä¸‰ä¸ªç‚¹å¹¶é€‰æ‹©â€œå¸æˆ·è¯¦ç»†ä¿¡æ¯â€>â€œå¯¼å‡ºç§é’¥â€æ¥å®Œæˆã€‚**

#### 4. ç°åœ¨ï¼Œæˆ‘ä»¬è¦éƒ¨ç½²åˆçº¦ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ç§»åŠ¨åˆ°ç»ˆç«¯å¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åšåˆ°è¿™ä¸€ç‚¹ï¼š

```shell
npx hardhat run scripts/deploy.js --network rinkeby
```

å®ƒå¥æ•ˆäº†å—ï¼Ÿæ¿€åŠ¨ã€‚

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220917093753.png)

æˆ‘ä»¬éƒ¨ç½²äº†åˆçº¦ï¼Œå¹¶ä¸”æˆ‘ä»¬åœ¨åŒºå—é“¾ä¸Šä¹Ÿæœ‰å®ƒçš„åœ°å€ã€‚è¯·è®°ä¸‹æŸå¤„çš„åœ°å€ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç½‘ç«™å°†éœ€è¦æ­¤åœ°å€ï¼Œä»¥ä¾¿å®ƒçŸ¥é“åœ¨åŒºå—é“¾ä¸ŠæŸ¥æ‰¾æ‚¨çš„åˆçº¦çš„ä½ç½®ã€‚

## åœ¨ React ä¸­æ„å»º Web åº”ç”¨ç¨‹åº

### 1. ä½¿ç”¨ Metamask è®¾ç½®ä¸€ä¸ªåŸºæœ¬çš„ React åº”ç”¨ç¨‹åº

æ˜¯æ—¶å€™å¼€å§‹å¼€å‘æˆ‘ä»¬çš„ç½‘ç»œåº”ç”¨äº†ã€‚æˆ‘ä»¬çš„åˆåŒå¾ˆç®€å•ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬å¼„æ¸…æ¥šå‰ç«¯åº”ç”¨ç¨‹åºå¦‚ä½•ä¸æˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦è¿›è¡Œäº¤äº’ã€‚

> **æ³¨æ„ï¼šæˆ‘ä»¬å·²ç»ä¸ºæ‚¨æ„å»ºäº†ä¸€ä¸ªå…¥é—¨å·¥å…·åŒ…ï¼è¿™æ˜¯å­˜å‚¨åº“çš„[é“¾æ¥ã€‚](https://github.com/niiischall/pickup-lines-starter-kit)æ‚¨å¯ä»¥å…‹éš†å­˜å‚¨åº“å¹¶å¼€å§‹å·¥ä½œã€‚**
>
> è¿™ç¯‡åšæ–‡çš„ç›®çš„æ˜¯è®©æ‚¨ä¹ æƒ¯åŒºå—é“¾å¼€å‘ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¸ä¼šæ·±å…¥æ¢è®¨å‰ç«¯å¼€å‘ã€‚

### 2. å°†é’±åŒ…è¿æ¥åˆ°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åº

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªä»¥å¤ªåŠé’±åŒ…ã€‚æœ‰å¾ˆå¤šå¯ç”¨çš„ï¼Œä½†å¯¹äºè¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨**Metamask**ã€‚[ä¸‹è½½å…¶æµè§ˆå™¨æ‰©å±•å¹¶åœ¨æ­¤å¤„](https://metamask.io/)è®¾ç½®æ‚¨çš„é’±åŒ…ã€‚

åœ¨`src`æ–‡ä»¶å¤¹å†…çš„`App.tsx`æ–‡ä»¶ä¸­ï¼Œè¾“å…¥ä»¥ä¸‹ä»£ç ï¼š

```tsx
import React, { useEffect, useState }  from "react";
import { ethers } from "ethers";
import './App.css';

/*This will be present on the terminal once you deploy the contract.*/
const contractAddress = '0x52BB......';
/*Copy-Paste the ABI file from the contract folder into this repository.*/
import abi from "./utils/PickupLines.json";

export default function App() {
  /*State variable to store the account connected with the wallet.*/
  const [currentAccount, setCurrentAccount] = useState("");

  /*Function to check if the wallet is connected to the app.*/
  const checkIfWalletIsConnected = async () => {
    try {
      const { ethereum } = window;

      if (!ethereum) {
        console.log("Make sure you have metamask!");
        return;
      } else {
        console.log("We have the ethereum object", ethereum);
      }

      const accounts = await ethereum.request({ method: "eth_accounts" });

      if (accounts.length !== 0) {
        const account = accounts[0];
        console.log("Found an authorized account:", account);
        setCurrentAccount(account);
      } else {
        console.log("No authorized account found")
      }
    } catch (error) {
      console.log(error);
    }
  }

  /*Function to connect the wallet*/
  const connectWallet = async () => {
    try {
      const { ethereum } = window;
      if (!ethereum) {
        alert("Get MetaMask!");
        return;
      }
      const accounts = await ethereum.request({ method: "eth_requestAccounts" });
      console.log("Connected", accounts[0]);
      setCurrentAccount(accounts[0]);
    } catch (error) {
      console.log(error)
    }
  }

 /*React hook to check for wallet connection when the app is mounted.*/
  useEffect(() => {
    checkIfWalletIsConnected();
  }, []);

  return (
    <div className="mainContainer">
      <div className="dataContainer">
        <div className="header">
        ğŸ§€ Hey there!
        </div>
        <div className="bio">
        <span>Welcome to Pick-Up Lines!</span>
        <button className="button" onClick={null}>
          Shoot Line
        </button>

        {/*If there is no current account render this button*/}
        {!currentAccount && (
          <button className="button" onClick={connectWallet}>
            Connect Wallet
          </button>
        )
      </div>
    </div>
    </div>
  );
}

```

### 3. ä»æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºè°ƒç”¨æ™ºèƒ½åˆçº¦

æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªå‰ç«¯åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬å·²ç»éƒ¨ç½²äº†æˆ‘ä»¬çš„åˆçº¦ã€‚æˆ‘ä»¬å·²ç»è¿æ¥äº†æˆ‘ä»¬çš„é’±åŒ…ã€‚ç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬å¯ä»¥ä» Metamask è®¿é—®çš„å‡­æ®ä»å‰ç«¯è°ƒç”¨æˆ‘ä»¬çš„åˆçº¦ã€‚

åœ¨`App.tsx`æ–‡ä»¶å†…çš„`App`ç»„ä»¶ä¸­æ·»åŠ ä»¥ä¸‹`pickup`å‡½æ•°ï¼š

```tsx
const pickup = async () => {
    try {
      const { ethereum } = window;

      if (ethereum) {
        const provider = new ethers.providers.Web3Provider(ethereum);
        const signer = provider.getSigner();
        const contract = new ethers.Contract(contractAddress, contractABI, signer);

        /*Get the count of all lines before adding a new line*/
        let count = await contract.getTotalLines();
        console.log("Retrieved total lines...", count.toNumber());

        /*Execute the actual pickup lines from your smart contract*/
        const contractTxn = await contract.wave();
        console.log("Mining...", contractTxn.hash);

        await contractTxn.wait();
        console.log("Mined -- ", contractTxn.hash);

        /*Get the count of all lines after adding a new line*/
        count = await contract.getTotalLines();
        console.log("Retrieved total lines count...", count.toNumber());
      } else {
        console.log("Ethereum object doesn't exist!");
      }
    } catch (error) {
      console.log(error);
    }
}

```

ç°åœ¨è¦è°ƒç”¨è¯¥å‡½æ•°ï¼Œè®©æˆ‘ä»¬åœ¨`App.tsx`æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªæŒ‰é’®ã€‚æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š

```tsx
<button className="button" onClick={pickup}>
    Send a line
</button>

```

å½“ä½ è¿è¡Œå®ƒæ—¶ï¼Œä½ ä¼šçœ‹åˆ°æ€»è¡Œæ•°å¢åŠ äº† 1ã€‚ä½ è¿˜ä¼šçœ‹åˆ° Metamask å¼¹å‡ºæˆ‘ä»¬å¹¶è¦æ±‚æˆ‘ä»¬æ”¯ä»˜æˆ‘ä»¬ä½¿ç”¨å‡åŠ å¯†æ”¯ä»˜çš„â€œgasâ€ã€‚

## å‘å¹¸è¿ç”¨æˆ·å‘é€ä¸€äº›ä»¥å¤ªåŠ

### 1. è®¾ç½®å¥–å“å¹¶é€‰æ‹©ç”¨æˆ·å‘é€ä»¥å¤ªåŠ

æ‰€ä»¥ç°åœ¨ï¼Œæˆ‘ä»¬çš„ä»£ç è®¾ç½®ä¸ºæ¯æ¬¡å­˜å‚¨éšæœºæå–æ­è®ªã€‚è®©æˆ‘ä»¬é€šè¿‡åœ¨`newLine`å‡½æ•°ä¸­æ·»åŠ å¥–åŠ±ç®—æ³•æ¥ä½¿å…¶æ›´æœ‰è¶£ã€‚ä¿®æ”¹`PickupLines.sol`æ–‡ä»¶ä¸­çš„`newLine`å‡½æ•°ï¼š

```tsx
function newLine(string memory _line) public {
  if (hasWrote[msg.sender]) {
    revert(
      "It seems you've posted a line already. We don't do repeats when it comes to picking up lines!"
     );
   }
  /*Adding a new Pickup Line to our blockchain.*/
  totalLines += 1;
  pickuplines.push(PickUpLine(msg.sender, _line, block.timestamp));
  hasWrote[msg.sender] = true;
  emit NewPickUpLine(msg.sender, block.timestamp, _line);

 /*Reward 10% of the senders by creating a random seed number.*/
 seed = (block.difficulty + block.timestamp + seed) % 100;
 if (seed <= 10) {
  uint256 prizeAmount = 0.0001 ether;
  require(
    prizeAmount <= address(this).balance,
    "The contract has insufficient ETH balance."
  );
  (bool success, ) = (msg.sender).call{value: prizeAmount}("");
  require(success, "Failed to withdraw ETH from the contract");
  }
}

```

åœ¨è¿™é‡Œï¼Œç®—æ³•éœ€è¦ä¸€ä¸ªéšæœºæ•°ã€‚æˆ‘ä»¬é‡‡ç”¨ Solidity ç»™æˆ‘ä»¬çš„ä¸¤ä¸ªæ•°å­—`block.difficulty`å’Œ`block.timestamp`ï¼Œå¹¶å°†å®ƒä»¬ç»„åˆèµ·æ¥åˆ›å»ºä¸€ä¸ªéšæœºæ•°ã€‚

ä¸ºäº†ä½¿è¿™ä¸ªéšæœºæ•°æ›´åŠ éšæœºï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª`seed`å˜é‡ï¼Œæ¯æ¬¡ç”¨æˆ·å‘é€æ–°è¡Œæ—¶è¯¥å˜é‡éƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚æˆ‘ä»¬ç»“åˆæ‰€æœ‰è¿™ä¸‰ä¸ªå˜é‡æ¥ç”Ÿæˆä¸€ä¸ªæ–°çš„éšæœºç§å­ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦è¯¥å€¼åœ¨ 0-99 çš„èŒƒå›´å†…ï¼Œä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†é€šè¿‡åº”ç”¨ seed æ¥ä½¿ç”¨æ¨¡è¿ç®—ç¬¦ï¼ˆ%ï¼‰`% 100`ã€‚

## æœ€åçš„æ­¥éª¤

### 1. é˜²æ­¢åƒåœ¾é‚®ä»¶å‘é€è€…

ç°åœ¨ï¼Œæ‚¨å¯ä»¥éšæœºé€‰æ‹©è¦å¥–åŠ±çš„äººã€‚å‘æ‚¨çš„ç½‘ç«™æ·»åŠ æ¡ä»¶å¾ˆæœ‰ç”¨ï¼Œè¿™æ ·äººä»¬å°±ä¸ä¼šåªæ˜¯å‘æ‚¨å‘é€åƒåœ¾é‚®ä»¶ã€‚

ä¸ºä»€ä¹ˆï¼Ÿå¥½å§ï¼Œä¹Ÿè®¸æ‚¨åªæ˜¯ä¸å¸Œæœ›ä»–ä»¬é€šè¿‡å‘æ‚¨å‘é€å¤šæ¡æ­è®ªæ¥ä¸€éåˆä¸€éåœ°è¯•å›¾èµ¢å¾—å¥–åŠ±ã€‚æˆ–è€…ï¼Œä¹Ÿè®¸æ‚¨ä¸å¸Œæœ›ä»–ä»¬çš„æ¶ˆæ¯å¡«æ»¡æ‚¨çš„æ¶ˆæ¯å¢™ã€‚ä¿®æ”¹`PickupLines.sol`æ–‡ä»¶é‡Œé¢çš„`newLine`å‡½æ•°ï¼š

```solidity
contract PickUpLines {
    mapping(address => bool) hasWrote;

    struct PickUpLine {
        address writer;
        string line;
        uint256 timestamp;
    }
    PickUpLine[] pickuplines;

   /*Adding a new Pickup Line to our blockchain.*/
    function newLine(string memory _line) public {

       /*Condition to check for repetitive submission.*/
        if (hasWrote[msg.sender]) {
            revert(
                "It seems you've posted a line already. We don't do repeats when it comes to picking up lines!"
            );
        }

        hasWrote[msg.sender] = true;
    }
}

```

### 2. å®Œæˆ

æ­å–œï¼æ‚¨å·²ç»å®Œæˆäº†æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ã€‚

ç°åœ¨ï¼Œæ˜¯æ—¶å€™æŠŠå®ƒå˜æˆä½ è‡ªå·±çš„äº†ã€‚æ›´æ”¹ CSSã€æ–‡æœ¬ã€æ·»åŠ ä¸€äº›åª’ä½“åµŒå…¥ã€æ·»åŠ æ›´å¤šåŠŸèƒ½ç­‰ç­‰ã€‚è®©ä¸œè¥¿çœ‹èµ·æ¥å¾ˆé…·:)ã€‚

## ç»“è®º

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/eR5c14rAW.gif)

è¿™ä¸ªåŒºå—é“¾åº”ç”¨ç¨‹åºæ€»æ˜¯å¯ä»¥æƒ³åˆ°å¤šé¡¹æ”¹è¿›/åŠŸèƒ½ã€‚éšæ„å°è¯•ä»£ç ä»¥æé«˜æ‚¨çš„æŠ€èƒ½ã€‚

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/my.png)