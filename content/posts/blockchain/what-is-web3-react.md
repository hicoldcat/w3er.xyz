---
title: ä»€ä¹ˆæ˜¯ Web3-React ä»¥åŠå¦‚ä½•å°†å…¶ç”¨äº dApp å‰ç«¯ï¼Ÿ
description: null
author: æç•™ç™½
weight: 0
date: 2023-03-12T13:12:15.372Z
lastmod: 2023-03-12T13:30:12.678Z
tags: []
categories:
  - åŒºå—é“¾
featuredImage: https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/202303122115607.png
---

ä½ åœ¨æ„å»º dApp å—ï¼Ÿå¦‚æœæ˜¯ï¼Œé‚£ä¹ˆæ‚¨å¿…é¡»éœ€è¦å°†æ‚¨çš„ dApp è¿æ¥åˆ°é’±åŒ…ã€‚Web3-react å¯èƒ½æ­£æ˜¯æ‚¨æ­£åœ¨å¯»æ‰¾çš„å·¥å…·ï¼

[Web3-react](https://github.com/NoahZinsmeister/web3-react/tree/v6)æ˜¯ç”± Noah Zinsmeister åˆ›å»ºçš„ web3 æ¡†æ¶ï¼Œç”¨äºå¸®åŠ©åŒºå—é“¾å¼€å‘äººå‘˜ä½¿ç”¨ React hooks åˆ¶ä½œç°ä»£ä»¥å¤ªåŠ dAppã€‚

è®©æˆ‘ä»¬æ¢ç´¢ web3-reactï¼ğŸ‘‡â€

## ä»€ä¹ˆæ˜¯ Web3-reactï¼Ÿ

Web3-react æ˜¯ä¸€ä¸ªåŸºäº React çš„æ¡†æ¶ï¼Œæœ‰åŠ©äºç®€åŒ– dApp çš„å‰ç«¯å¼€å‘ã€‚

Web3-react è¿˜å……å½“çŠ¶æ€æœºï¼Œç»´æŠ¤ä¸ dApp ç›¸å…³çš„æ•°æ®ï¼Œå¹¶å°†å…¶æ³¨å…¥ç»„ä»¶æ ‘ä¸­éœ€è¦çš„ä»»ä½•ä½ç½®ã€‚Web3-React æ”¯æŒèŒƒå›´å¹¿æ³›çš„é’±åŒ…ï¼Œä» Metamask å’Œ Coinbase ç­‰æµè§ˆå™¨é’±åŒ…åˆ° Trezor å’Œ Ledger ç­‰ç¡¬ä»¶é’±åŒ…ã€‚

åœ¨[LearnWeb3](https://www.learnweb3.io/)ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ Web3-Modal åœ¨ dApps ä¸­è¿›è¡Œé’±åŒ…è¿æ¥ã€‚Web3-Modal éå¸¸é€‚åˆåˆå­¦è€…ï¼Œä½†éšç€æˆ‘ä»¬æ‰©å±•é¡¹ç›®ï¼Œå¤„ç† Web3-Modal å˜å¾—æ›´åŠ å›°éš¾ã€‚

å› æ­¤ web3-react å¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºï¼š

- å®ƒæ›´é€‚åˆæ„å»ºç°ä»£ dApp
- æ‹¥æœ‰æ›´å¥½çš„å¼€å‘è€…ä½“éªŒ
- å‡å°‘ä»£ç å†—ä½™
- å¹¶ä¸”æ˜¯ä¸€ä¸ªç›´è§‚çš„æ¡†æ¶

## ä¸ºä»€ä¹ˆä½¿ç”¨ Web3-react å¯èƒ½æ˜¯ä¸€ä¸ªæ›´å¥½çš„ä¸»æ„ï¼Ÿ

Web3-React åœ¨å¾ˆå¤šæ–¹é¢æä¾›äº†çµæ´»æ€§ã€‚å¦‚å‰æ‰€è¿°ï¼Œå®ƒå¯¹è®¸å¤šé’±åŒ…éƒ½æœ‰å¾ˆå¥½çš„æ”¯æŒã€‚

ä½†å³ä½¿é’±åŒ…æœªåŒ…å«åœ¨ web3-react åŒ…ä¸­ï¼Œæ‚¨ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå®šä¹‰è¿æ¥å™¨å¹¶è¿æ¥ web3-react ä¸­åˆ—å‡ºçš„é’±åŒ…ä»¥å¤–çš„é’±åŒ…ï¼

Web3-react åœ¨åº•å±‚ä½¿ç”¨ Ethers.js æˆ– Web3.jsï¼Œä»è€Œæä¾›æµç•…çš„ä½“éªŒï¼Œå› ä¸º**ä»…**ä½¿ç”¨ether.js è¿æ¥é’±åŒ…å¯èƒ½æ˜¯ä¸€ä¸ªéå¸¸ç—›è‹¦çš„è¿‡ç¨‹ã€‚

*æ³¨æ„*ï¼šåœ¨ç»§ç»­ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨äº†è§£ ContextAPIï¼Œæ¢å¥è¯è¯´ï¼ŒuseContext hookã€‚è¿™æ˜¯ Web3-React çš„å…³é”®ç‰¹æ€§ã€‚

## å®‰è£… web3-react

è®©æˆ‘ä»¬å®‰è£… web3-reactï¼

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å‡è®¾æ‚¨å·²ç»è®¾ç½®äº† ReactJS/NextJS åº”ç”¨ç¨‹åºã€‚

åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºç›®å½•ä¸­ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å®‰è£… web-reactï¼š

```
npm install @web-react/core
```

æˆ–è€…

```
yarn add @web3-react/core
```

ç°åœ¨ï¼Œä¸ºäº†è¿æ¥åŸºäºæµè§ˆå™¨çš„é’±åŒ…ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…ä»¥ä¸‹ web3-react åŒ…ï¼š

```
npm install @web3-react/injected-connector
```

æˆ–è€…

```
yarn add @web3-react/injected-connector
```

è€Œä¸”..ä½ æ‹¥æœ‰å°†ä½ çš„ dApp è¿æ¥åˆ°æµè§ˆå™¨é’±åŒ…æ‰€éœ€çš„æ‰€æœ‰è¦ç´ ï¼è®©æˆ‘ä»¬å¼€å§‹ç¼–å†™è¿æ¥é’±åŒ…çš„ä»£ç å§ï¼

## è¿æ¥é’±åŒ…

æœ¬èŠ‚å‡è®¾æ‚¨å·²ç»åˆ›å»ºäº†åº”ç”¨ç¨‹åºå¹¶å®‰è£…äº†ä¹‹å‰çš„ä¾èµ–é¡¹ã€‚æ—¢ç„¶å·²ç»è§£å†³äº†ï¼Œè®©æˆ‘ä»¬ç›´æ¥è¿›å…¥è¿™ä¸ªï¼

### ç¬¬ 1 æ­¥ï¼šè®¾ç½®**Web3ReactProvider**

è®©æˆ‘ä»¬è·³è½¬åˆ°`pages`æ–‡ä»¶å¤¹ä¸‹çš„ï¼ˆå¯¹äºä¸‹ä¸€æ­¥ï¼‰`_app.js`æ–‡ä»¶ï¼

ç¼–è¾‘ä»£ç ï¼Œä½¿å…¶çœ‹èµ·æ¥åƒè¿™æ ·ğŸ‘‡â€

```js
import '../styles/globals.css'
import { Web3ReactProvider } from '@web3-react/core'
import { providers, Web3Provider } from 'ethers'

function getLibrary(provider, connector) {
  return new providers.Web3Provider(provider)
}

function MyApp({ Component, pageProps }) {
  return(
    <Web3ReactProvider getLibrary={getLibrary}>
      <Component {...pageProps} />
    </Web3ReactProvider>
  )
}

export default MyApp

```

å®Œæˆäº†å—ï¼Ÿç°åœ¨è®©æˆ‘ä»¬æ¥ç†è§£ä¸€ä¸‹è¿™æ®µä»£ç ï¼

- æ­¤å‡½æ•°è¿”å›æä¾›è€…å¯¹è±¡ã€‚

```js
function getLibrary(provider, connector) {
  return new providers.Web3Provider(provider)
}
```

- Web3ReactProvider æ˜¯ä¸Šä¸‹æ–‡æä¾›è€…ï¼Œå®ƒå°†æ‰€æœ‰æ•°æ®å‘ä¸‹ä¼ é€’åˆ°ç»„ä»¶æ ‘ã€‚

```js
function MyApp({ Component, pageProps }) {
return (
  <Web3ReactProvider getLibrary={getLibrary}>
    <Component {...pageProps} />
  </Web3ReactProvider>
 )
}
```

### ç¬¬ 2 æ­¥ï¼šè®¾ç½®æŒ‚é’©

ç°åœ¨è®©æˆ‘ä»¬è¿›å…¥æ‚¨çš„`pages`æ–‡ä»¶å¤¹`index.js`ã€‚

```js
import Head from 'next/head'
import Image from 'next/image'
import styles from '../styles/Home.module.css'
import { InjectedConnector } from '@web3-react/injected-connector'
import { useWeb3React } from '@web3-react/core'
import { useState } from 'react'
import { CONTRACT_ADDRESS, CONTRACT_ABI } from '../constants'

export default function Home() {

  const [ result, setResult ] = useState("")

  // web3-react hook, helps in fetching 
  // the data passed by Web3ReactProvider
  const { active, activate, deactivate, account, library, connector, error } = useWeb3React()

  // injected provider identifier
  const injected = new InjectedConnector(
    {
      supportedChainIds:[80001]
    }
  )

  const connectWallet = async () => {
    try {
      await activate(injected)
    } catch (err) {
      console.error(err)
    }
  }

  const disconnectWallet = async () => {
    try {
      deactivate(injected)
    } catch (err) {
      console.error(err)
    }
  }
return (
    <div className={styles.container}>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <button onClick={connectWallet}>Connect Wallet</button>
      {active? <span>Connected with <b>{account}</b></span>: <span>Not Connected</span>}
      <button onClick={disconnectWallet}>Disconnect Wallet</button>

    </div>
  )
}

```

å¥½çš„ï¼Œç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹**useWeb3React** hook

```js
const { active, activate, deactivate, account, library, connector, error } = useWeb3React()
```

- `useWeb3React`æ˜¯æ¥è‡ª web-react åº“çš„è‡ªå®šä¹‰æŒ‚é’©ï¼Œå®ƒè¿”å›è®¸å¤šæœ‰ç”¨çš„åŠŸèƒ½ã€‚
- è¿™ä¸ªé’©å­è¿”å›ï¼š

```
  connector;
  // connector object returns some useful connection
  // methods like activate() and deactivate()

  library;
  // library is the provider object that we 
  // passed with the Web3ReactProvider

  chainId;
  // returns the chainId for the account that
  // is connected to the dApp

  account;
  // the account address of the connected account

  active;   
  // active is a state variable which returns boolean values
  // that determines whether the wallet connection is 
  // active or inactive

  error;
  // returns any error happening with the wallet connection
```

ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹**æ³¨å…¥çš„**å˜é‡ -

```
const injected = new InjectedConnector({
      supportedChainIds:[80001]
})
// we can list multiple networks by listing their
// chainIds, separated by comma
```

- **Injected Connector**æ˜¯ä¸€ä¸ªç±»ï¼Œå®ƒæ¥å—å—æ”¯æŒçš„ chainIds çš„è¾“å…¥å¹¶è¿”å›ä¸€ç»„ä¸æµè§ˆå™¨é’±åŒ…äº¤äº’çš„æ–¹æ³•ã€‚
- å¦‚æœé’±åŒ…æœªè¿æ¥åˆ°æ­£ç¡®çš„ç½‘ç»œï¼Œå®ƒå°†è¿”å›`UnsupportedChainId`é”™è¯¯ã€‚`error`å¯ä»¥ä»`useWeb3React`é’©å­è¿”å›çš„å¯¹è±¡è®¿é—®æ­¤é”™è¯¯ã€‚

è‡³äº`activate(injected)`å’Œ`deactivate(injected)`ï¼Œå®ƒä»¬æ˜¯è¿æ¥æˆ–æ–­å¼€æ³¨å…¥æä¾›è€…ï¼ˆæµè§ˆå™¨é’±åŒ…ï¼‰çš„æ–¹æ³•ã€‚

BOOM ğŸ’¥ ä½ **å·²ç»**å‡†å¤‡å¥½é’±åŒ…è¿æ¥è®¾ç½®äº†ï¼

## åˆåŒä¸­çš„è¯»å†™

ç°åœ¨æˆ‘ä»¬å·²ç»è¿æ¥äº†æˆ‘ä»¬çš„é’±åŒ…ï¼Œå‰©ä¸‹çš„å°±æ˜¯è¯»å†™åŒºå—é“¾çš„æ–¹å¼äº†ï¼

æˆ‘ä»¬å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ï¼Ÿ

æˆ‘ä»¬å°†ä½¿ç”¨ web3-react `library`(provider) å¯¹è±¡ä»åŒºå—é“¾è¯»å–/å†™å…¥åŒºå—é“¾

å› æ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨åœ¨ LearnWeb3DAO çš„ Freshman Track ä¸­æ„å»ºçš„ Mood dApp åˆçº¦ã€‚[å•å‡»æ­¤å¤„](https://www.learnweb3.io/tracks/freshman/dapp-tutorial)è·å–æ™ºèƒ½åˆçº¦ã€‚

åœ¨æˆ‘ä»¬æ·±å…¥ç ”ç©¶ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨å·²ç»åœ¨`constants`æ–‡ä»¶å¤¹ä¸­ï¼ˆåœ¨æ ¹ç›®å½•ä¸­ï¼‰åˆ›å»ºäº†ä¸€ä¸ª`index.js`ï¼Œå¹¶ä¸”å®ƒåº”è¯¥å…·æœ‰ä»¥ä¸‹ä»£ç  -

```js
// put your contract address in place of this gibberish
export const CONTRACT_ADDRESS = "0xabcabcabcabcabcabc";

// put your abi in this variable, it will be of the form [{},{}]
export const CONTRACT_ABI = [...]
```

### é˜…è¯»

è¦ä»æ™ºèƒ½åˆçº¦ä¸­è¯»å–æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦ä¸¤ä»¶äº‹â€”â€”

- åˆçº¦å®ä¾‹
- æä¾›è€…

å› æ­¤ï¼Œè®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªä»æ™ºèƒ½åˆçº¦ä¸­è¯»å–çš„å‡½æ•°ï¼

```js
const getMood = async () => {

    const provider = library;

    const contract = new Contract(
      CONRTACT_ADDRESS,
      CONTRACT_ABI,
      provider
    );

    const tx = await contract.getMood();
    tx.wait();
    setResult(tx);
  }
```

- æˆ‘ä»¬å°†`provider`å˜é‡è®¾ç½®ä¸º`library`. è¯·è®°ä½ï¼Œ`library`æ˜¯ä»`useWeb3React`é’©å­è¿”å›çš„ï¼Œå®ƒæ˜¯ä¸€ä¸ªæä¾›è€…å¯¹è±¡ã€‚å¾ˆæ–¹ä¾¿ï¼Œä¸æ˜¯å—ï¼Ÿ
- ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„ Contract å®ä¾‹ï¼Œè¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸åˆåŒè¿›è¡Œäº¤äº’ã€‚
- ç°åœ¨æ˜¯åˆ›å»ºäº¤æ˜“çš„æ—¶å€™äº†ï¼æˆ‘ä»¬åœ¨è¿™é‡Œè°ƒç”¨åˆçº¦ä¸­çš„ getMood() å‡½æ•°ã€‚
- `tx.wait()`ç­‰å¾…äº¤æ˜“å®Œæˆã€‚
- `setResult(tx)`å°†çŠ¶æ€å˜é‡`result`çš„å€¼è®¾ç½®ä¸º`tx`çš„å€¼ã€‚

### å†™ä½œ

ä¸ºäº†é€šè¿‡æ™ºèƒ½åˆçº¦ç¼–å†™ï¼Œæˆ‘ä»¬éœ€è¦ä¸¤ä»¶äº‹â€”â€”

- åˆçº¦å®ä¾‹
- ç­¾åè€…ï¼ˆç­¾ç½²äº¤æ˜“ï¼‰

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå†™ä½œåŠŸèƒ½ï¼

```js
const setMood = async ( mood ) => {

    const signer = await library.getSigner()

    const contract = new Contract(
      CONRTACT_ADDRESS,
      CONTRACT_ABI,
      signer
    )

    const tx = await contract.setMood(mood)
    tx.wait()
    alert("Mood set!")
  }
```

ç°åœ¨æƒ…å†µå‘ç”Ÿäº†å˜åŒ–ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥åœ°æ¢ç´¢å®ƒä»¬â€”â€”

- `library`æ˜¯ä¸€ä¸ªæä¾›è€…å¯¹è±¡ï¼Œä½†æˆ‘ä»¬éœ€è¦ä¸€ä¸ªç­¾åè€…ï¼Œå¯¹å—ï¼Ÿå¥½å§ï¼Œä¸€ä¸ªæä¾›è€…å¯¹è±¡æœ‰ä¸€ä¸ªæ–¹æ³•å«åš`getSigner()`è¿”å›é™„åŠ åˆ°è¿™ä¸ªæä¾›è€…çš„ç­¾åè€…å¯¹è±¡ï¼
- `contract`æ˜¯ä¸€ä¸ª Contract å®ä¾‹ï¼Œä½†åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ²¡æœ‰ä¼ é€’æä¾›è€…ï¼Œè€Œæ˜¯ä¼ é€’äº†ä¸€ä¸ªç­¾åè€…ï¼Œå› ä¸ºä¸ºäº†ç¼–å†™äº¤æ˜“ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç­¾åè€…æ¥ç­¾ç½²äº¤æ˜“ã€‚
- æœ€åï¼Œæˆ‘ä»¬ç°åœ¨å·²ç»å°†ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™åˆçº¦å‡½æ•°ï¼Œå› ä¸ºåˆçº¦ä¸­çš„å‡½æ•°éœ€è¦ä¸€ä¸ªå‚æ•°æ¥è®¾ç½®å¿ƒæƒ…ã€‚

LFGï¼! ä½ å·²ç»ç”¨ web3-react åˆ¶ä½œäº†ä¸€ä¸ª dApp å‰ç«¯ï¼å®ƒä¹Ÿå¯ä»¥åœ¨åŒºå—é“¾ä¸Šè¯»å–å’Œå†™å…¥ï¼ğŸ’ªâ€

## ç»“è®º

Web3-react æ˜¯ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„æ¡†æ¶ï¼Œç”¨äºåœ¨ React/NextJS ä¸­æ„å»º dApp å‰ç«¯ã€‚

è¿™æ˜¯ä¸€ä¸ªéå¸¸æ˜“äºä½¿ç”¨çš„å·¥å…·ï¼Œä½†å®ƒå¯èƒ½ä¼šè®©åˆå­¦è€…æ„Ÿåˆ°å›°æƒ‘ã€‚è¦ä½¿ç”¨æ­¤å·¥å…·ï¼Œæ‚¨å¯èƒ½éœ€è¦äº†è§£ Context APIã€‚

æ³¨æ„ï¼š**Web3-React**æ²¡æœ‰å¾ˆå¥½çš„æ–‡æ¡£ï¼Œä»–ä»¬ repo çš„ä¸»è¦åˆ†æ”¯ç”šè‡³æ²¡æœ‰æ–‡æ¡£ã€‚è¦é˜…è¯»ä»–ä»¬çš„æ–‡æ¡£ï¼Œè¯·è½¬åˆ°ä»–ä»¬çš„[`v6`](https://github.com/NoahZinsmeister/web3-react/tree/v6)åˆ†æ”¯ã€‚

è¿™ç¯‡åšå®¢å°±å†™åˆ°è¿™é‡Œ!

ä¸‹æ¬¡å†è§ã€‚ğŸ˜„

> åŸæ–‡ï¼šhttps://blog.learnweb3.io/what-is-web3-react

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/profile.jpg)