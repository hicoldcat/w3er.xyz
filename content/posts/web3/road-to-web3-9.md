---
title: Web3ä¹‹è·¯â€”â€”å¦‚ä½•ç”¨Lensåè®®åˆ›å»ºä¸€ä¸ªå»ä¸­å¿ƒåŒ–çš„Twitter
description: null
author: æç•™ç™½
weight: 0
date: 2022-08-31T13:39:39.538Z
lastmod: 2022-08-31T14:50:22.198Z
tags: []
categories:
  - åŒºå—é“¾
  - WEB3.0
featuredImage: https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220814204307.png
---

æœ€è¿‘æœ‰å¾ˆå¤šå…³äºFacebookå’ŒTwitterç­‰ç¤¾äº¤åª’ä½“å·¨å¤´æœ‰å¤šå¤§æ§åˆ¶æƒçš„è®¨è®ºã€‚ä¸ç®¡ä½ å¯¹å®ƒçš„çœ‹æ³•å¦‚ä½•ï¼Œæˆ‘æƒ³å’Œä½ åˆ†äº«ä¸€ä¸ªè¶…çº§ä»¤äººå…´å¥‹çš„å®éªŒã€‚

ä»Šå¹´ï¼ŒAaveå›¢é˜Ÿçš„æœ‹å‹ä»¬æ¨å‡ºäº†ä¸€ä¸ªåä¸ºLens Protocolçš„é¡¹ç›®ã€‚è¿™æ˜¯æœ€è¿‘è¿›å…¥web3ç”Ÿæ€ç³»ç»Ÿçš„æœ€ä»¤äººå…´å¥‹çš„æŠ€æœ¯ä¹‹ä¸€ï¼Œå› ä¸ºå®ƒä½¿ç”¨åŒºå—é“¾æŠ€æœ¯ï¼Œå°†æ•°æ®çš„æƒåŠ›å’Œæ§åˆ¶æƒäº¤è¿˜ç»™äº§ç”Ÿæ•°æ®çš„ç”¨æˆ·ã€‚

æ‰€ä»¥æˆ‘æƒ³ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ä¸€èµ·æ¢ç´¢å®ƒå‘¢ï¼Ÿè¿™å°†æ˜¯ä¸€ä¸ªåˆé€‚çš„æœ€åä¸€è¯¾ï¼ŒæŠŠä½ åˆ°ç›®å‰ä¸ºæ­¢æ‰€å­¦çš„ä¸€åˆ‡ç»“åˆèµ·æ¥ğŸ™‚ã€‚

åœ¨è¿™ä¸€è¯¾ä¸­ï¼Œä½ å°†å­¦ä¹ ã€‚

- å¦‚ä½•ç”¨Apollo GraphQLå®¢æˆ·ç«¯è®¾ç½®ä¸€ä¸ªNext.jsåº”ç”¨
- å¦‚ä½•ä½¿ç”¨Lensåè®®APIæ¥è·å–PolygonåŒºå—é“¾ä¸Šå­˜å‚¨çš„èµ„æ–™ã€å¸–å­å’Œå…¶ä»–æ•°æ®
- ä»‹ç»MintKudos API -- è¿™æ ·ä½ å°±å¯ä»¥åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­æ•´åˆä½ çš„PoK tokenäº†
- å¯¹Litåè®®çš„ä»‹ç» -- å¦‚æœä½ æƒ³å¯¹æŸäº›å¸–å­è¿›è¡ŒåŠ å¯†ï¼Œåªå‘ä¸åŒçš„ç¤¾åŒºæˆå‘˜å±•ç¤ºã€‚
- å¦‚ä½•ä½¿ç”¨Repl.itéƒ¨ç½²ä½ çš„å»ä¸­å¿ƒåŒ–çš„ç¤¾äº¤åª’ä½“åº”ç”¨å‰ç«¯ç½‘ç«™
- å¤šä¸ªæŒ‘æˆ˜é€‰é¡¹æ¥æ‰©å±•è¿™ä¸ªé¡¹ç›®!

è¿™é‡Œæœ‰ä¸€ä¸ª[Github Repo](https://github.com/thatguyintech/road-to-lens)ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªå·²å®Œæˆé¡¹ç›®çš„ä¾‹å­ï¼Œä»¥é˜²ä½ éœ€è¦å®ƒæ¥è·Ÿéšã€‚

è®©æˆ‘ä»¬å¼€å§‹å§!

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220831214321.png)

### ç¬¬0æ­¥ï¼šå‚è§‚Lensåè®®çš„ç”Ÿæ€ç³»ç»Ÿ

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220831214339.png)

https://lens.xyz/

è®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹Lensåè®®æä¾›äº†ä»€ä¹ˆå§!

å¦‚æœä½ è®¿é—®[Lensç½‘ç«™](https://lens.xyz/)ï¼Œä½ ä¼šç«‹å³çœ‹åˆ°ä¸¤ä¸ªé“¾æ¥ã€‚

- å¼€å‘è€…å›­åœ° - å¸¦ä½ åˆ°æ–‡æ¡£å’ŒæŒ‡å—
- åŠ å…¥ Discord - å¸¦ä½ åˆ°ç¤¾åŒºèŠå¤©æœåŠ¡å™¨

æˆ‘ä»¬å°†åœ¨ä¸€ç§’é’Ÿå†…è®¿é—®å¼€å‘è€…èŠ±å›­ï¼Œä½†åœ¨æ­¤ä¹‹å‰ï¼Œè®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹å³ä¸Šæ–¹çš„èœå•æ é€‰é¡¹ã€‚

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220831214943.png)

*ä½ å¯ä»¥æŸ¥çœ‹å·²ç»ç”±ç¤¾åŒºå»ºç«‹çš„åº”ç”¨ç¨‹åº*

åœ¨è¿™é‡Œï¼Œæˆ‘å°†æè¯·ä½ æ³¨æ„ä¸¤ä»¶äº‹ã€‚

1. **Claim Handle**  - æˆªè‡³ç›®å‰ï¼ˆ7/13/2022ï¼‰ï¼ŒLensåè®®ä»å¤„äºå¼€æ”¾æµ‹è¯•é˜¶æ®µï¼Œæ‰€ä»¥ä½ éœ€è¦è·å¾—å…è®¸åˆ—è¡¨ï¼Œä»¥ä¾¿ä¸ºä½ çš„é’±åŒ…åœ°å€ç”³é¢†ä¸€ä¸ªhandle ã€‚å¹¸è¿çš„æ˜¯ï¼Œå¦‚æœä½ ä¸€ç›´åœ¨å…³æ³¨Road To Web3ç¤¾åŒºè®¡åˆ’ï¼Œå¹¶åœ¨è¿‡å»è·å¾—äº†çŸ¥è¯†è¯æ˜NFTï¼Œé‚£ä¹ˆä½ å¾ˆå¯èƒ½å·²ç»è¢«åˆ—å…¥äº†å…è®¸åå•ï¼å¦‚æœæ²¡æœ‰ï¼Œè¯·åˆ°é˜¿å°”åŠå°”å¤§å­¦æ¥ã€‚å¦‚æœæ²¡æœ‰ï¼Œè¯·è¿›å…¥ [Alchemy Discord](http://alchemy.com/discord) ï¼Œåœ¨[#week-10](https://discord.com/channels/735965332958871634/996103339416768593/996103993564610661)é¢‘é“ä¸­è¯¢é—®æ­¤äº‹ã€‚ä¸€æ—¦ä½ å¾—åˆ°ä½ çš„handleï¼Œè¯·æŸ¥çœ‹Lensterä¸Šçš„[Road To Web3ç¤¾åŒº ](https://lenster.xyz/communities/0x25c4-0x0c)ğŸ”¥
2. åº”ç”¨ç¨‹åº - è¿™ä¸ªé“¾æ¥ä¼šå¸¦ä½ åˆ°ä¸€ä¸ªç¤¾åŒºå»ºç«‹çš„ç½‘ç»œåº”ç”¨åˆ—è¡¨ï¼ŒåŒ…æ‹¬åƒLensfrensã€Lensterã€Phaverã€Alps Financeã€Refractç­‰ã€‚

https://twitter.com/thatguyintech/status/1546561239756615680

æˆ‘æƒ³ç”¨ä¸€ä¸ªç®€çŸ­çš„æ—¶é—´æ¥è¯´æ˜Lensåè®®çš„åŠ›é‡ã€‚

å¦‚æœä½ è®¿é—®lensfrensçš„è¿™ä¸ªä¸ªäººèµ„æ–™é¡µé¢--https://www.lensfrens.xyz/thatguyintech.lensï¼Œä½ ä¼šçœ‹åˆ°æˆ‘çš„è´¦æˆ·ï¼Œå®ƒåº”è¯¥æ˜¯è¿™æ ·çš„ã€‚

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220831215318.png)

ç°åœ¨ï¼Œå¦‚æœä½ è®¿é—®è¿™ä¸ªå®Œå…¨ä¸åŒçš„ç½‘ç»œåº”ç”¨Lenster - https://lenster.xyz/u/thatguyintech.lens - ä½ ä¼šå†æ¬¡çœ‹åˆ°æˆ‘ï¼Œæœ‰å®Œå…¨ç›¸åŒçš„ä¸ªäººèµ„æ–™æ•°æ®ï¼Œåªæ˜¯ä½“éªŒå®Œå…¨ä¸åŒï¼Œç”šè‡³åŒ…æ‹¬å…¶ä»–ä¸ªäººèµ„æ–™çš„å¸–å­/è¯„è®º/ååº”ã€‚

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220831215401.png)

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ²¡æœ‰ä»€ä¹ˆè¶…çº§éœ‡æ’¼çš„ä¸œè¥¿ï¼Œä½†åœ¨è¿™é‡ŒåšæŒæˆ‘çš„è§‚ç‚¹ã€‚

çœ‹çœ‹å…¶ä»–çš„åº”ç”¨ç¨‹åºã€‚

- Phaver - æ”¯æŒLensçš„ç¤¾äº¤ç§»åŠ¨åº”ç”¨ï¼ŒALSOè®©ä½  "å…¥è‚¡ "æ¥ç­–åˆ’å…¶ä»–äººçš„å¸–å­ï¼Œä»è€Œè®©äººä»¬ä¸ºä»–ä»¬çš„å†…å®¹èµšé’±ã€‚

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220831222109.png)

- Refract - å®ƒå°±åƒHacker Newsï¼Œåªæ˜¯è¿™é‡Œåˆ†äº«çš„æ‰€æœ‰é“¾æ¥å’Œå¸–å­éƒ½ç”±Lens Protocolæä¾›ã€‚

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220831222127.png)

è¿™äº›åº”ç”¨éƒ½æ˜¯ç”±ä¸åŒçš„äººã€ä¸åŒçš„å›¢é˜Ÿå»ºç«‹çš„ï¼Œæœ‰ç€ä¸åŒçš„ç”¨æˆ·ä½“éªŒå’Œäº§å“ç›®æ ‡ï¼Œä½†æ‰€æœ‰çš„åº•å±‚æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå°±å¥½åƒä»–ä»¬éƒ½å…±äº«åŒä¸€ä¸ªæ•°æ®åº“å’ŒAPIã€‚

è¿™æ€ä¹ˆå¯èƒ½å‘¢ï¼Ÿ

äº‹å®è¯æ˜ï¼Œå…±äº«æ•°æ®åº“å’Œå…¬å…±APIæ­£æ˜¯Lens Protocolçš„åŸºæœ¬æ€æƒ³ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™é¡¹æŠ€æœ¯æœ‰å¦‚æ­¤å¤§çš„æ½œåŠ›ã€‚

æ¯ä¸€å—æ•°æ®éƒ½æ˜¯ä¸€ä¸ªNFTã€‚

æ¯ä¸ªå¸–å­ï¼Œæ¯ä¸ªè¯„è®ºï¼Œæ¯ä¸ªååº”ï¼Œæ¯ä¸ªFOLLOWã€‚è¿™äº›æ•°æ®ä¸­çš„æ¯ä¸€ä¸ªéƒ½è¢«å­˜å‚¨ä¸ºç”±ä½ è¿™ä¸ªåˆ›é€ è€…åˆ›å»ºå’Œæ§åˆ¶çš„ä¸å¯ä¼ªé€ çš„ä»¤ç‰Œã€‚

è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬ä½œä¸ºç”¨æˆ·åˆ›å»ºçš„æ•°å­—å†…å®¹å’Œå…³ç³»æ˜¯ç”±æˆ‘ä»¬è‡ªå·±æ‹¥æœ‰çš„ï¼Œå¹¶ä¸”å¯ä»¥è¢«å¸¦åˆ°ä»»ä½•å»ºç«‹åœ¨åè®®ä¹‹ä¸Šçš„åº”ç”¨ä¸­å»

ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹è¡ŒåŠ¨å§!

### ç¬¬1æ­¥ï¼šè®¾ç½®Next.jsåº”ç”¨ç¨‹åºå¹¶å®‰è£…Apollo

æ‰“å¼€ä¸€ä¸ªå‘½ä»¤è¡Œã€‚ä½¿ç”¨create-next-appæ¥å¯åŠ¨ä¸€ä¸ªé¡¹ç›®ï¼Œè¯¥é¡¹ç›®å°†è¢«å‘½åä¸ºroad-to-lens

```bash
npx create-next-app road-to-lens
```

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220831222218.png)


ç”Ÿæˆçš„ repo å°†è¢«ç§°ä¸º road-to-lensï¼Œä½ åº”è¯¥æœ‰ä»¥ä¸‹ç›®å½•ç»“æ„ã€‚

```
thatguyintech@albert road-to-lens % tree -L 1
.
â”œâ”€â”€ README.md
â”œâ”€â”€ next.config.js
â”œâ”€â”€ node_modules
â”œâ”€â”€ package.json
â”œâ”€â”€ pages
â”œâ”€â”€ public
â”œâ”€â”€ styles
â””â”€â”€ yarn.lock
```

è®©æˆ‘ä»¬åœ¨è¿™é‡Œä¹Ÿå®‰è£…æˆ‘ä»¬çš„graphqlå®¢æˆ·ç«¯ã€‚æˆ‘ä»¬å°†ä½¿ç”¨Apolloæ¥æŸ¥è¯¢Lensåè®®çš„æ•°æ®ã€‚

```
npm install @apollo/client graphql
```

å®Œæˆè¿™äº›åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨å¹¶åŠ è½½ç½‘é¡µæ¥è¿›è¡Œç†æ™ºæ£€æŸ¥ã€‚

```javascript
thatguyintech@albert road-to-lens % npm run dev

> road-to-lens@0.1.0 dev
> next dev

ready - started server on 0.0.0.0:3000, url: http://localhost:3000
info  - SWC minify release candidate enabled. https://nextjs.link/swcmin
event - compiled client and server successfully in 4.2s (169 modules)
```

åŠ è½½http://localhost:3000ï¼Œåº”è¯¥ä¼šå¾—åˆ°ä¸€ä¸ªåŸºæœ¬çš„æ¨¡æ¿é¡µé¢ï¼Œçœ‹èµ·æ¥åƒè¿™æ ·ã€‚

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220831222230.png)

###  ç¬¬2æ­¥ï¼šåœ¨index.jsé¡µé¢ä¸Šè¯•ç”¨Apollo GraphQLä¸Lensçš„æ¨èé…ç½®æ–‡ä»¶

è®©æˆ‘ä»¬é€šè¿‡åœ¨ä¸»é¡µä¸ŠåŠ è½½Lensæ¨èçš„é…ç½®æ–‡ä»¶æ¥ç†Ÿæ‚‰ä¸€ä¸‹Apolloå’ŒGraphQLã€‚

é¦–å…ˆï¼Œè®¾ç½®Apolloæä¾›è€…æ¥åŒ…è£…æˆ‘ä»¬çš„æ•´ä¸ªåº”ç”¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ä»¥åè®¿é—®useQueryå’ŒuseMutationç­‰æ–¹æ³•ã€‚

åœ¨é¡¶å±‚ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåä¸ºapollo-client.js

```
thatguyintech@albert road-to-lens % touch apollo-client.js
```

æˆ‘ä»¬å°†åœ¨è¿™é‡Œåˆå§‹åŒ–ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå…¶åŸºæœ¬ç½‘å€æŒ‡å‘Lens Matic Mainnet APIã€‚

```javascript
// ./apollo-client.js

import { ApolloClient, InMemoryCache } from "@apollo/client";

const client = new ApolloClient({
    uri: "https://api.lens.dev",
    cache: new InMemoryCache(),
});

export default client;
```

æœ‰äº†è¿™ä¸ªGraphQLå®¢æˆ·ç«¯çš„åˆå§‹åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„/pages/_app.jsæ–‡ä»¶ä¸­å¯¼å…¥å®ƒï¼Œç”¨å®ƒæ¥åŒ…è£…æˆ‘ä»¬çš„å…¨å±€åº”ç”¨ç¨‹åºç»„ä»¶ã€‚

```javascript
// pages/_app.js

import '../styles/globals.css'
import { ApolloProvider } from "@apollo/client";
import client from "../apollo-client";

function MyApp({ Component, pageProps }) {
  return (
    <ApolloProvider client={client}>
      <Component {...pageProps} />
    </ApolloProvider>
  );
}

export default MyApp
```

ä½ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œæ·»åŠ äº†<ApolloProvider client={client}>ä½œä¸ºåŒ…è£…å™¨ã€‚è¿™è®©æˆ‘ä»¬çš„æ•´ä¸ªåº”ç”¨å…·æœ‰äº†è¶…èƒ½åŠ›--åœ¨å…¶ä»–åœ°æ–¹ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨useQueryå’ŒuseMutationè¿™æ ·çš„å®ç”¨æ–¹æ³•æ¥ä»Lens APIä¸­è·å–æ•°æ®ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥å‘é€æ›´æ–°ã€‚

åœ¨æˆ‘ä»¬å›åˆ°localhostæ£€æŸ¥ä¹‹å‰ï¼Œè¿˜æœ‰æœ€åä¸€æ¬¡æ›´æ–°ã€‚è®©æˆ‘ä»¬æ›´æ–°/pages/index.jsï¼Œä»Lensè·å–æ¨èæ¡£æ¡ˆçš„æŸ¥è¯¢ã€‚

```jsx
import { useQuery, gql } from "@apollo/client";

const recommendProfiles = gql`
  query RecommendedProfiles {
    recommendedProfiles {
          id
        name
        bio
        attributes {
          displayType
          traitType
          key
          value
        }
          followNftAddress
        metadata
        isDefault
        picture {
          ... on NftImage {
            contractAddress
            tokenId
            uri
            verified
          }
          ... on MediaSet {
            original {
              url
              mimeType
            }
          }
          __typename
        }
        handle
        coverPicture {
          ... on NftImage {
            contractAddress
            tokenId
            uri
            verified
          }
          ... on MediaSet {
            original {
              url
              mimeType
            }
          }
          __typename
        }
        ownedBy
        dispatcher {
          address
          canUseRelay
        }
        stats {
          totalFollowers
          totalFollowing
          totalPosts
          totalComments
          totalMirrors
          totalPublications
          totalCollects
        }
        followModule {
          ... on FeeFollowModuleSettings {
            type
            amount {
              asset {
                symbol
                name
                decimals
                address
              }
              value
            }
            recipient
          }
          ... on ProfileFollowModuleSettings {
          type
          }
          ... on RevertFollowModuleSettings {
          type
          }
        }
    }
  }
`;

export default function Home() {
  const {loading, error, data} = useQuery(recommendProfiles);

  if (loading) return 'Loading..';
  if (error) return `Error! ${error.message}`;

  return (
    <div>
      Hello
      {data.recommendedProfiles.map((profile, index) => {
        console.log(`Profile ${index}:`, profile);
        return (
          <div>
            <h1>{profile.name}</h1>
            <p>{profile.bio}</p>
            <div>{profile.attributes.map((attr, idx) => {
              if (attr.key === "website") {
                return <div><a href={`${attr.value}`}>{attr.value}</a><br/></div>
              } else if (attr.key === "twitter") {
                return <div><a href={`https://twitter.com/${attr.value}`}>@{attr.value}</a><br/></div>;
              }
              return(<div>{attr.value}</div>);
            })}</div>
          </div>
        );
      })}
    </div>
  )
}
```

æˆ‘ä»¬åœ¨è¿™ä¸ªå˜åŒ–ä¸­åšäº†å‡ ä»¶å…³é”®çš„äº‹æƒ…ã€‚

1. å®šä¹‰ä¸€ä¸ªåä¸º RecommendedProfiles çš„ GraphQL æŸ¥è¯¢ã€‚
2. é€šè¿‡è°ƒç”¨å¸¦æœ‰ RecommendedProfiles æŸ¥è¯¢çš„ useQuery æ¥è·å–é…ç½®æ–‡ä»¶åˆ—è¡¨ -> è¯¥åˆ—è¡¨å°†åœ¨æ•°æ®å˜é‡ä¸­è¿”å›ã€‚
3. æ˜¾ç¤ºä¸€äº›èµ„æ–™ä¿¡æ¯ï¼Œå¦‚data.profile.nameã€data.profile.bioå’Œdata.profile.attributeã€‚

å›åˆ°http://localhost:3000/ï¼ˆç¡®ä¿ä½ çš„æœ¬åœ°æœåŠ¡å™¨æ­£åœ¨è¿è¡Œï¼‰ï¼Œç„¶åvoilÃ¡ï¼Œä½ åº”è¯¥çœ‹åˆ°è¿™ä¸ªéå¸¸ç®€å•çš„é…ç½®æ–‡ä»¶åˆ—è¡¨

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220831222253.png)

ä¸‘é™‹ï¼Œä½†å¾ˆé…·å§ï¼Ÿ

å¦‚æœä½ æƒ³åœ¨è¿™é‡Œæš‚åœï¼Œåšä¸€äº›æ›´å¤šçš„æ¢ç´¢ï¼Œä½ å¯ä»¥åœ¨ä½ çš„/pages/index.jsæ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªconsole.logè¯­å¥ï¼Œä»¥æŸ¥çœ‹æ›´å¤šä»GraphQLæŸ¥è¯¢ä¸­è¿”å›çš„æ•°æ®ã€‚

ä¾‹å¦‚ï¼Œé€šè¿‡æ·»åŠ console.log(data)ï¼Œä½ å°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸Šæ‹‰å‡ºå¼€å‘è€…æ§åˆ¶å°ï¼Œçœ‹åˆ°ä¸ªäººèµ„æ–™æ•°æ®ã€‚

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220831222306.png)

æŸ¥çœ‹æ§åˆ¶å°ä¸­çš„RecommendedProfileså“åº”ï¼Œæˆ–åœ¨å¼€å‘è€…æ–‡æ¡£ä¸­æŸ¥çœ‹


æˆ‘ä»¬ä»¥åä¼šæ›´å¤šåœ°æŸ¥çœ‹è¿™äº›æ•°æ®ï¼Œå¹¶æ¸…ç†é¡µé¢è®¾è®¡ ğŸ™‚

æé†’ä¸€ä¸‹ï¼šæ‰€æœ‰è¿™äº›æ•°æ®éƒ½ä»¥NFTçš„å½¢å¼å­˜å‚¨åœ¨PolygonåŒºå—é“¾ä¸Šã€‚

Lenså›¢é˜Ÿç”¨ä»–ä»¬çš„APIæ‰€åšçš„åªæ˜¯å¯¹æ‰€æœ‰çš„é“¾ä¸Šæ•°æ®è¿›è¡Œç´¢å¼•ï¼Œè¿™æ ·å¼€å‘è€…å°±å¯ä»¥æ›´å®¹æ˜“åœ°ä½¿ç”¨NFTsæ¥è·å–å’Œæ„å»ºäº†

åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œå¿«é€Ÿçš„ç†æ™ºæ£€æŸ¥ã€‚

ä½ çš„ç›®å½•ç»“æ„åº”è¯¥æ˜¯è¿™æ ·çš„ã€‚

```bash
thatguyintech@albert road-to-lens % tree -L 2
.
â”œâ”€â”€ README.md
â”œâ”€â”€ apollo-client.js      <- we created this
â”œâ”€â”€ next.config.js
â”œâ”€â”€ node_modules
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ package.json
â”œâ”€â”€ pages
â”‚   â”œâ”€â”€ api
â”‚   â”œâ”€â”€ _app.js           <- we modified this
â”‚   â””â”€â”€ index.js          <- we modified this
â”œâ”€â”€ public
â”‚   â”œâ”€â”€ favicon.ico
â”‚   â””â”€â”€ vercel.svg
â”œâ”€â”€ styles
â”‚   â”œâ”€â”€ Home.module.css
â”‚   â””â”€â”€ globals.css
â””â”€â”€ yarn.lock
```

### ç¬¬3æ­¥ï¼šè®©æˆ‘ä»¬ä½¿é…ç½®æ–‡ä»¶åˆ—è¡¨çœ‹èµ·æ¥æ›´æ¼‚äº®

åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†é‡æ„æˆ‘ä»¬çš„ä»£ç ï¼Œä½¿å…¶æ›´å®¹æ˜“æµè§ˆï¼Œæˆ‘ä»¬è¿˜å°†è®¾è®¡æˆ‘ä»¬çš„ç»„ä»¶ï¼Œä½¿ç”¨æˆ·ç•Œé¢çœ‹èµ·æ¥æ›´å¹²å‡€ã€‚

ä»é‡æ„å¼€å§‹ã€‚

è¿™æ˜¯æˆ‘ä»¬æ–°çš„/pages/index.js

```javascript
import { useQuery } from "@apollo/client";
import recommendedProfilesQuery from '../queries/recommendedProfilesQuery.js';
import Profile from '../components/Profile.js';

export default function Home() {
  const {loading, error, data} = useQuery(recommendedProfilesQuery);

  if (loading) return 'Loading..';
  if (error) return `Error! ${error.message}`;

  return (
    <div>
      {data.recommendedProfilesQuery.map((profile, index) => {
        console.log(`Profile ${index}:`, profile);
        return <Profile key={profile.id} profile={profile} displayFullProfile={false} />;
      })}
    </div>
  )
}
```

æˆ‘ä»¬è¦æŠŠ recommendProfilesQuery ç§»åˆ°ä¸€ä¸ªå•ç‹¬çš„ Graphql æ–‡æ¡£ä¸­ï¼Œæ”¾åœ¨ä¸€ä¸ªä½ éœ€è¦åˆ›å»ºçš„åä¸º queries çš„æ–°æ–‡ä»¶å¤¹ä¸­ã€‚

```bash
mkdir queries
touch queries/recommendedProfilesQuery.js
```

ç„¶åæŠŠ RecommendedProfiles æ–‡æ¡£å¤åˆ¶åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚

```javascript
// queries/recommendedProfilesQuery.js

import {gql} from '@apollo/client';

export default gql`
  query RecommendedProfiles {
    recommendedProfiles {
          id
        name
        bio
        attributes {
          displayType
          traitType
          key
          value
        }
          followNftAddress
        metadata
        isDefault
        picture {
          ... on NftImage {
            contractAddress
            tokenId
            uri
            verified
          }
          ... on MediaSet {
            original {
              url
              mimeType
            }
          }
          __typename
        }
        handle
        coverPicture {
          ... on NftImage {
            contractAddress
            tokenId
            uri
            verified
          }
          ... on MediaSet {
            original {
              url
              mimeType
            }
          }
          __typename
        }
        ownedBy
        dispatcher {
          address
          canUseRelay
        }
        stats {
          totalFollowers
          totalFollowing
          totalPosts
          totalComments
          totalMirrors
          totalPublications
          totalCollects
        }
        followModule {
          ... on FeeFollowModuleSettings {
            type
            amount {
              asset {
                symbol
                name
                decimals
                address
              }
              value
            }
            recipient
          }
          ... on ProfileFollowModuleSettings {
          type
          }
          ... on RevertFollowModuleSettings {
          type
          }
        }
    }
  }
`;
```

ç„¶åè®©æˆ‘ä»¬ä¹Ÿåˆ›å»ºæˆ‘ä»¬åœ¨ä¸Šé¢çš„index.jsé¡µé¢ä¸­ä»‹ç»çš„Profileç»„ä»¶ï¼ˆ import Profile from '.../components/Profile.js';)

æˆ‘ä»¬åº”è¯¥æŠŠå®ƒç»„ç»‡åˆ°ä¸€ä¸ªæ–°çš„ç›®å½•ä¸­ï¼Œç§°ä¸ºç»„ä»¶ã€‚

```bash
mkdir components
touch components/Profile.js
```

ç„¶åæŠŠè¿™ä¸ªç»“æ„å¤åˆ¶è¿›å»å°±å¯ä»¥äº†ã€‚

```javascript
// components/Profile.js

import Link from "next/link";
export default function Profile(props) {
  const profile = props.profile;

  // When displayFullProfile is true, we show more info.
  const displayFullProfile = props.displayFullProfile;

  return (
    <div className="p-8">
      <Link href={`/profile/${profile.id}`}>
        <div className="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl">
          <div className="md:flex">
            <div className="md:shrink-0">
              {profile.picture ? (
                <img
                  src={
                    profile.picture.original
                      ? profile.picture.original.url
                      : profile.picture.uri
                  }
                  className="h-48 w-full object-cover md:h-full md:w-48"
                />
              ) : (
                <div
                  style={{
                    backgrondColor: "gray",
                  }}
                  className="h-48 w-full object-cover md:h-full md:w-48"
                />
              )}
            </div>
            <div className="p-8">
              <div className="uppercase tracking-wide text-sm text-indigo-500 font-semibold">
                {profile.handle}
                {displayFullProfile &&
                  profile.name &&
                  " (" + profile.name + ")"}
              </div>
              <div className="block mt-1 text-sm leading-tight font-medium text-black hover:underline">
                {profile.bio}
              </div>
              <div className="mt-2 text-sm text-slate-900">{profile.ownedBy}</div>
              <p className="mt-2 text-xs text-slate-500">
                following: {profile.stats.totalFollowing} followers:{" "}
                {profile.stats.totalFollowers}
              </p>
            </div>
          </div>
        </div>
      </Link>
    </div>
  );
}
```

è¿™ä¸ªProfileç»„ä»¶æ¥å—propsä½œä¸ºè¾“å…¥ï¼Œå¹¶å¸Œæœ›propså¯¹è±¡æœ‰ä¸€ä¸ªprofileå­—æ®µï¼Œå…¶ä¸­åŒ…æ‹¬æˆ‘ä»¬åœ¨æ¸²æŸ“ç»„ä»¶æ—¶å¯èƒ½æƒ³è¦æ˜¾ç¤ºçš„æ‰€æœ‰ä¿¡æ¯ã€‚

å½“æˆ‘ä»¬åœ¨è¿™é‡Œçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿæ·»åŠ äº†ä¸ªäººèµ„æ–™çš„å›¾ç‰‡å’Œè¿½éšè€…/å…³æ³¨è€…çš„æ•°é‡!

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å†ä¸€æ¬¡æ£€æŸ¥æˆ‘ä»¬çš„å·¥ä½œã€‚ç»å¸¸æ£€æŸ¥æˆ‘ä»¬çš„å·¥ä½œæ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œå› ä¸ºå®ƒå¯ä»¥è®©æˆ‘ä»¬è¿…é€ŸæŠ“ä½é”™è¯¯

ç¡®ä¿ä½ çš„æœåŠ¡å™¨æ­£åœ¨è¿è¡Œã€‚

```bash
thatguyintech@albert road-to-lens % npm run dev

> road-to-lens@0.1.0 dev
> next dev

ready - started server on 0.0.0.0:3000, url: http://localhost:3000
```

ç„¶åå»è®¿é—®localhost: http://localhost:3000/

ä½ åº”è¯¥çœ‹åˆ°åƒè¿™æ ·çš„ä¸œè¥¿ã€‚

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220831222408.png)


å®ƒä»ç„¶ä¸æ˜¯é‚£ä¹ˆå¥½çœ‹ï¼Œä½†æ˜¯ï¼Œå˜¿ï¼Œæˆ‘ä»¬æœ‰ç…§ç‰‡ï¼"ã€‚

åœ¨æˆ‘ä»¬å®Œæˆè¿™ä¸€æ­¥ä¹‹å‰ï¼Œè®©æˆ‘ä»¬åˆ©ç”¨æˆ‘ä»¬åŒ…å«åœ¨ç®€ä»‹ç»„ä»¶ä¸­çš„CSSçš„ä¼˜åŠ¿ã€‚

å¦‚æœä½ ä»¥å‰ä»æœªä½¿ç”¨è¿‡Tailwindçš„CSSï¼Œè¿™äº›æ ‡ç­¾ã€‚

```
å¤§å†™å­—æ¯ tracking-wide text-sm text-indigo-500 font-semibold
```

éƒ½æ¥è‡ªäºTailwindè®¾è®¡çš„å®ç”¨æ€§ä¼˜å…ˆçš„åŸºæœ¬åŸåˆ™ï¼ˆ[è§æ–‡æ¡£](https://tailwindcss.com/docs/responsive-design)ï¼‰ã€‚

å› æ­¤ï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨è¿™é‡Œè¦åšçš„å°±æ˜¯æŒ‰ç…§ä»–ä»¬çš„[å®‰è£…è¯´æ˜](https://tailwindcss.com/docs/guides/nextjs)ï¼Œå®‰è£…Tailwindã€‚

```bash
npm install -D tailwindcss postcss autoprefixer
npx tailwindcss init -p
```

å¤åˆ¶è¿™äº›é…ç½®ï¼Œä»¥ä¾¿TailwindçŸ¥é“åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­è¦åŠ è½½å“ªäº›è·¯å¾„çš„æ ·å¼ã€‚æˆ‘ä»¬å¸Œæœ›é¡µé¢æ–‡ä»¶å¤¹å’Œç»„ä»¶æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰å†…å®¹éƒ½è¢«è¦†ç›–ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨è¿™äº›è·¯å¾„ã€‚

```javascript
// tailwind.config.js

module.exports = {
  content: [
    "./pages/**/*.{js,ts,jsx,tsx}",
    "./components/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {},
  },
  plugins: [],
}
```

ç°åœ¨ï¼Œæˆ‘ä»¬é€šè¿‡å°†TailwindæŒ‡ä»¤æ·»åŠ åˆ°æˆ‘ä»¬çš„CSSæ–‡ä»¶ä¸­æ¥æ”¶å°¾ã€‚

```css
/* ./styles/globals.css */
@tailwind base;
@tailwind components;
@tailwind utilities;
```

ç„¶åé‡æ–°å¯åŠ¨æœåŠ¡å™¨ï¼Œçœ‹çœ‹å®ƒç°åœ¨çœ‹èµ·æ¥æ€ä¹ˆæ ·äº†

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220831222421.png)


å®ƒçœ‹èµ·æ¥æ£’æäº†ã€‚ç”šè‡³è¿˜æœ‰é˜´å½±å’Œä¸€åˆ‡ ğŸ™‚

ç°åœ¨......ä½ ä»¬ä¸­çš„ä¸€äº›äººå¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œæˆ‘åœ¨ç®€ä»‹ç»„ä»¶ä¸­åŒ…å«äº†ä¸€äº›<é“¾æ¥>ï¼Œç„¶åå½“ä½ ç‚¹å‡»å…¶ä¸­ä¸€ä¸ªç®€ä»‹æ—¶ï¼Œå®ƒä¼šé“¾æ¥åˆ°ä¸€ä¸ªæ–°çš„é¡µé¢

ä¾‹å¦‚ï¼Œç‚¹å‡»DAVIDEV.LENSçš„å¡ç‰‡ï¼Œä¼šæŠŠæˆ‘ä»¬å¸¦åˆ°http://localhost:3000/profile/0x16ï¼Œå¹¶æ˜¾ç¤ºä¸€ä¸ª404é”™è¯¯ã€‚

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220831222432.png)


ä¸ç”¨æ‹…å¿ƒï¼Œåœ¨ä¸‹ä¸€æ­¥ï¼Œè®©æˆ‘ä»¬å»ºç«‹è¿™ä¸ªé¡µé¢ï¼Œå¹¶è¿›è¡Œç¬¬äºŒä¸ªGraphQLæŸ¥è¯¢ï¼Œä»¥è·å–Publicationsï¼ˆåˆç§° "å¸–å­"ï¼Œåƒå…¶ä»–ç¤¾äº¤åª’ä½“å¹³å°ï¼‰ã€‚

### ç¬¬4æ­¥ï¼šåˆ›å»ºä¸ªäººç®€ä»‹é¡µé¢

ä½¿ç”¨Next.jsæ¡†æ¶å¿«é€Ÿæ„å»ºçš„æœ€é…·çš„äº‹æƒ…ä¹‹ä¸€æ˜¯è·¯ç”±ï¼å¯¹äºæˆ‘ä»¬çš„ä¸ªäººç®€ä»‹é¡µé¢ï¼Œæˆ‘ä»¬æ‰€åšçš„ä¸€åˆ‡æ˜¯ä¸ºäº†è·å¾—æ›´å¤šçš„ä¿¡æ¯ã€‚å¯¹äºæˆ‘ä»¬çš„ä¸ªäººç®€ä»‹é¡µé¢ï¼Œæˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯åœ¨pagesæ–‡ä»¶å¤¹ä¸‹å»ºç«‹ä¸€ä¸ªä¸æˆ‘ä»¬çš„ç®€ä»‹ç»„ä»¶åŒåçš„æ–‡ä»¶å¤¹ã€‚ç„¶åæ·»åŠ ä¸€ä¸ª[id].jsæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å¯ç”¨äºä¼ é€’åˆ°è·¯ç”±ä¸­çš„ä»»ä½•åŠ¨æ€id!

è¿™å°±æ˜¯æˆ‘çš„æ„æ€ã€‚

```bash
road-to-lens % mkdir pages/profile
road-to-lens % touch pages/profile/\[id\].js
```

æˆ‘ä»¬ç¨åå°†å¡«å†™pages/profile/[id].jsæ–‡ä»¶ã€‚ä½†æœ‰äº†è¿™ä¸ªæ–‡ä»¶ç»“æ„ï¼Œæˆ‘ä»¬çš„Next.jsåº”ç”¨ç¨‹åºå°†èƒ½å¤Ÿä¸ºè¯¸å¦‚ä»¥ä¸‹URLçš„è¯·æ±‚æä¾›æœåŠ¡ã€‚

- http://localhost:3000/profile/0x9752
- http://localhost:3000/profile/0x25c4

å› æ­¤ï¼Œè®©æˆ‘ä»¬é€šè¿‡å‘Lens APIè®¾ç½®ä¸€ä¸ªæ–°çš„GraphQLè¯·æ±‚æ¥è·å–ä¸ªäººèµ„æ–™ä¿¡æ¯ï¼Œç„¶åæˆ‘ä»¬å°†åœ¨[id].jsæ–‡ä»¶ä¸­æ„å»ºç»„ä»¶æ¥å®Œæˆè¿™ä¸ªå·¥ä½œã€‚

ä¸ºäº†è·å–ä¸ªäººç®€ä»‹ä¿¡æ¯ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªGraphQLæ–‡æ¡£ï¼Œå°±åƒæˆ‘ä»¬ä¹‹å‰ä¸ºè·å–æ•´ä¸ªæ¨èç®€ä»‹åˆ—è¡¨æ‰€åšçš„é‚£æ ·ã€‚

```
road-to-lens % touch queries/fetchProfileQuery.js
```



```bash
// queries/fetchProfileQuery.js

import { gql } from '@apollo/client';

export default gql`
query($request: SingleProfileQueryRequest!) {
    profile(request: $request) {
        id
        name
        bio
        attributes {
          displayType
          traitType
          key
          value
        }
        followNftAddress
        metadata
        isDefault
        picture {
          ... on NftImage {
            contractAddress
            tokenId
            uri
            verified
          }
          ... on MediaSet {
            original {
              url
              mimeType
            }
          }
          __typename
        }
        handle
        coverPicture {
          ... on NftImage {
            contractAddress
            tokenId
            uri
            verified
          }
          ... on MediaSet {
            original {
              url
              mimeType
            }
          }
          __typename
        }
        ownedBy
        dispatcher {
          address
          canUseRelay
        }
        stats {
          totalFollowers
          totalFollowing
          totalPosts
          totalComments
          totalMirrors
          totalPublications
          totalCollects
        }
        followModule {
          ... on FeeFollowModuleSettings {
            type
            amount {
              asset {
                symbol
                name
                decimals
                address
              }
              value
            }
            recipient
          }
          ... on ProfileFollowModuleSettings {
            type
          }
          ... on RevertFollowModuleSettings {
            type
          }
        }
    }
  }
`;
```

ç°åœ¨ï¼Œè®©æˆ‘ä»¬åœ¨ä¸ªäººç®€ä»‹é¡µä¸­ä½¿ç”¨è¿™ä¸ªæŸ¥è¯¢å§!

```javascript
// pages/profile/[id].js

import { useQuery } from "@apollo/client";
import { useRouter } from "next/router";
import fetchProfileQuery from "../../queries/fetchProfileQuery.js";

import Profile from "../../components/Profile.js";

export default function ProfilePage() {
  const router = useRouter();
  const { id } = router.query;

  console.log("fetching profile for", id);
  const { loading, error, data } = useQuery(fetchProfileQuery, {
    variables: { request: { profileId: id } },
  });

  if (loading) return "Loading..";
  if (error) return `Error! ${error.message}`;

  console.log("on profile page data: ", data);

  return <Profile profile={data.profile} displayFullProfile={true}/>
}
```

å¦‚æœä½ çœ‹ä¸€ä¸‹æˆ‘ä»¬æ·»åŠ çš„æ–‡ä»¶ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªç†Ÿæ‚‰çš„useQuery()è°ƒç”¨ï¼Œå®ƒæ¥æ”¶äº†ä»"././queries/fetchProfileQuery.js "å¯¼å…¥çš„fetchProfileQuery GraphQLæ–‡æ¡£ã€‚

æ–°çš„æ˜¯ï¼Œæˆ‘ä»¬ç°åœ¨è¿˜å¼•å…¥äº†useRouter()é’©å­ã€‚è¿™ä¸ªé’©å­å…è®¸æˆ‘ä»¬åœ¨è¿è¡Œæ—¶ä»URLçš„æŸ¥è¯¢å‚æ•°ä¸­æŠ“å–ä»»ä½•å˜é‡[id]å€¼ï¼Œç„¶ååœ¨æˆ‘ä»¬çš„ä»£ç ä¸­ä½¿ç”¨ã€‚

è¿™æ„å‘³ç€ï¼Œå¦‚æœæˆ‘ä»¬æœ‰è¿™äº›URLã€‚

- http://localhost:3000/profile/0x9752
- http://localhost:3000/profile/0x25c4

useRouter()è°ƒç”¨å°†è·å–ä»¥ä¸‹idä¸º const { id } = router.query; :

- 0x9752
- 0x25c4

ç„¶åæˆ‘ä»¬ç”¨è¿™äº›idä¼ å…¥fetchProfileQueryï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åªæŠ“å–æˆ‘ä»¬æ­£åœ¨æµè§ˆçš„é‚£ä¸ªäººçš„èµ„æ–™ã€‚ä½ å¯ä»¥[åœ¨è¿™é‡Œæ‰¾åˆ°](https://docs.lens.xyz/docs/get-profile)è·å–ä¸ªäººèµ„æ–™è¯·æ±‚çš„å®Œæ•´æ–‡æ¡£ã€‚

å¥½çš„ï¼Œç‚¹å‡»ä¿å­˜ã€‚åˆ·æ–°é¡µé¢! ä½ çœ‹åˆ°äº†ä»€ä¹ˆï¼Ÿ

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220831222449.png)

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220831222454.png)

å¥½äº†ï¼Œå¦‚æœåˆ°ç›®å‰ä¸ºæ­¢ä½ çš„ä¸€åˆ‡éƒ½å¾ˆé¡ºåˆ© -- ä¸€å®šè¦åº†ç¥è¿™ä¸ªé‡Œç¨‹ç¢‘ï¼ˆå¦‚æœä½ è¢«å¡ä½äº†ï¼Œä¹Ÿå¯ä»¥è¯·æ±‚å¸®åŠ©ï¼‰ã€‚

ä½ å·²ç»æˆåŠŸäº†ä¸€åŠä»¥ä¸Š!

### ç¬¬5æ­¥ï¼šåœ¨ç®€ä»‹é¡µä¸ŠåŠ è½½ç”¨æˆ·å¸–å­

è®©æˆ‘ä»¬é€šè¿‡è·å–ç”¨æˆ·æ‰€å‘çš„ä¸€äº›å¸–å­ï¼Œä½¿ä¸ªäººèµ„æ–™é¡µå˜å¾—æ›´æœ‰è¶£ã€‚

åœ¨Lensåè®®ä¸­ï¼Œå¸–å­ã€è¯„è®ºå’Œé•œåƒï¼ˆåˆç§° "è½¬å‘"ï¼‰--éƒ½è¢«å½’å…¥Publicationsæ•°æ®æ¨¡å‹ã€‚

æ‚¨å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°[å‘å¸ƒç«¯ç‚¹çš„æ–‡æ¡£](https://docs.lens.xyz/docs/publication-1)ã€‚æˆ‘ä»¬å°†ä¸“æ³¨äº[ GET Publication](https://docs.lens.xyz/docs/get-publication) æ“ä½œã€‚å†ä¸€æ¬¡ï¼Œè®©æˆ‘ä»¬éµå¾ªåŒæ ·çš„é¡ºåºã€‚

1. è®¾ç½®GraphQLæŸ¥è¯¢æ–‡æ¡£ã€‚
2. æ›´æ–°é…ç½®æ–‡ä»¶é¡µé¢ï¼Œä»¥ä½¿ç”¨æ–°çš„GraphQLæŸ¥è¯¢ã€‚
3. ä¸º "post "åˆ›å»ºä¸€ä¸ªæ–°çš„ç»„ä»¶å®šä¹‰ã€‚
4. æŠŠä»Lens APIè¿”å›çš„æ•°æ®ä¼ é€’åˆ°æ–°çš„ç»„ä»¶ä¸­ã€‚
5. æµ‹è¯•å’Œè°ƒè¯•é¡µé¢!

#### 1. è®¾ç½®GraphQLæŸ¥è¯¢æ–‡æ¡£

è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä¸€ä¸ªå…¨æ–°çš„æ–‡æ¡£æ–‡ä»¶ã€‚æˆ‘ä»¬å¯ä»¥ä¿®æ”¹æˆ‘ä»¬åœ¨fetchProfileQuery.jsä¸­å¼€å§‹çš„æŸ¥è¯¢ï¼Œä»¥ä¾¿åœ¨åŒä¸€è¯·æ±‚ä¸­ä¹Ÿè¯¢é—®Publicationsã€‚è¿™å°±æ˜¯GraphQLçš„åŠ›é‡! ä¸REST APIè°ƒç”¨ä¸åŒçš„æ˜¯ï¼Œä½ å¯ä»¥åœ¨ä¸€ä¸ªè¯·æ±‚ä¸­è¦æ±‚æ›´å¤šæˆ–æ›´å°‘ã€‚è®©æˆ‘ä»¬å¯¹ queries/fetchProfileQuery.js è¿›è¡Œè¿™ä¸€æ›´æ–°ã€‚

```graphql
import { gql } from "@apollo/client";

export default gql`
  query (
    $request: SingleProfileQueryRequest!
    $publicationsRequest: PublicationsQueryRequest!
  ) {
    publications( request: $publicationsRequest) {
      items {
        __typename
        ... on Post {
          ...PostFields
        }
        ... on Comment {
          ...CommentFields
        }
        ... on Mirror {
          ...MirrorFields
        }
      }
      pageInfo {
        prev
        next
        totalCount
      }
    }
    profile(request: $request) {
      id
      name
      bio
      attributes {
        displayType
        traitType
        key
        value
      }
      followNftAddress
      metadata
      isDefault
      picture {
        ... on NftImage {
          contractAddress
          tokenId
          uri
          verified
        }
        ... on MediaSet {
          original {
            url
            mimeType
          }
        }
        __typename
      }
      handle
      coverPicture {
        ... on NftImage {
          contractAddress
          tokenId
          uri
          verified
        }
        ... on MediaSet {
          original {
            url
            mimeType
          }
        }
        __typename
      }
      ownedBy
      dispatcher {
        address
        canUseRelay
      }
      stats {
        totalFollowers
        totalFollowing
        totalPosts
        totalComments
        totalMirrors
        totalPublications
        totalCollects
      }
      followModule {
        ... on FeeFollowModuleSettings {
          type
          amount {
            asset {
              symbol
              name
              decimals
              address
            }
            value
          }
          recipient
        }
        ... on ProfileFollowModuleSettings {
          type
        }
        ... on RevertFollowModuleSettings {
          type
        }
      }
    }
  }

  fragment MediaFields on Media {
    url
    mimeType
  }

  fragment ProfileFields on Profile {
    id
    name
    bio
    attributes {
      displayType
      traitType
      key
      value
    }
    isFollowedByMe
    isFollowing(who: null)
    followNftAddress
    metadata
    isDefault
    handle
    picture {
      ... on NftImage {
        contractAddress
        tokenId
        uri
        verified
      }
      ... on MediaSet {
        original {
          ...MediaFields
        }
      }
    }
    coverPicture {
      ... on NftImage {
        contractAddress
        tokenId
        uri
        verified
      }
      ... on MediaSet {
        original {
          ...MediaFields
        }
      }
    }
    ownedBy
    dispatcher {
      address
    }
    stats {
      totalFollowers
      totalFollowing
      totalPosts
      totalComments
      totalMirrors
      totalPublications
      totalCollects
    }
    followModule {
      ... on FeeFollowModuleSettings {
        type
        amount {
          asset {
            name
            symbol
            decimals
            address
          }
          value
        }
        recipient
      }
      ... on ProfileFollowModuleSettings {
        type
      }
      ... on RevertFollowModuleSettings {
        type
      }
    }
  }

  fragment PublicationStatsFields on PublicationStats {
    totalAmountOfMirrors
    totalAmountOfCollects
    totalAmountOfComments
  }

  fragment MetadataOutputFields on MetadataOutput {
    name
    description
    content
    media {
      original {
        ...MediaFields
      }
    }
    attributes {
      displayType
      traitType
      value
    }
  }

  fragment Erc20Fields on Erc20 {
    name
    symbol
    decimals
    address
  }

  fragment CollectModuleFields on CollectModule {
    __typename
    ... on FreeCollectModuleSettings {
      type
      followerOnly
      contractAddress
    }
    ... on FeeCollectModuleSettings {
      type
      amount {
        asset {
          ...Erc20Fields
        }
        value
      }
      recipient
      referralFee
    }
    ... on LimitedFeeCollectModuleSettings {
      type
      collectLimit
      amount {
        asset {
          ...Erc20Fields
        }
        value
      }
      recipient
      referralFee
    }
    ... on LimitedTimedFeeCollectModuleSettings {
      type
      collectLimit
      amount {
        asset {
          ...Erc20Fields
        }
        value
      }
      recipient
      referralFee
      endTimestamp
    }
    ... on RevertCollectModuleSettings {
      type
    }
    ... on TimedFeeCollectModuleSettings {
      type
      amount {
        asset {
          ...Erc20Fields
        }
        value
      }
      recipient
      referralFee
      endTimestamp
    }
  }

  fragment PostFields on Post {
    id
    profile {
      ...ProfileFields
    }
    stats {
      ...PublicationStatsFields
    }
    metadata {
      ...MetadataOutputFields
    }
    createdAt
    collectModule {
      ...CollectModuleFields
    }
    referenceModule {
      ... on FollowOnlyReferenceModuleSettings {
        type
      }
    }
    appId
    hidden
    mirrors(by: null)
    hasCollectedByMe
  }

  fragment MirrorBaseFields on Mirror {
    id
    profile {
      ...ProfileFields
    }
    stats {
      ...PublicationStatsFields
    }
    metadata {
      ...MetadataOutputFields
    }
    createdAt
    collectModule {
      ...CollectModuleFields
    }
    referenceModule {
      ... on FollowOnlyReferenceModuleSettings {
        type
      }
    }
    appId
    hidden
    hasCollectedByMe
  }

  fragment MirrorFields on Mirror {
    ...MirrorBaseFields
    mirrorOf {
      ... on Post {
        ...PostFields
      }
      ... on Comment {
        ...CommentFields
      }
    }
  }

  fragment CommentBaseFields on Comment {
    id
    profile {
      ...ProfileFields
    }
    stats {
      ...PublicationStatsFields
    }
    metadata {
      ...MetadataOutputFields
    }
    createdAt
    collectModule {
      ...CollectModuleFields
    }
    referenceModule {
      ... on FollowOnlyReferenceModuleSettings {
        type
      }
    }
    appId
    hidden
    mirrors(by: null)
    hasCollectedByMe
  }

  fragment CommentFields on Comment {
    ...CommentBaseFields
    mainPost {
      ... on Post {
        ...PostFields
      }
      ... on Mirror {
        ...MirrorBaseFields
        mirrorOf {
          ... on Post {
            ...PostFields
          }
          ... on Comment {
            ...CommentMirrorOfFields
          }
        }
      }
    }
  }

  fragment CommentMirrorOfFields on Comment {
    ...CommentBaseFields
    mainPost {
      ... on Post {
        ...PostFields
      }
      ... on Mirror {
        ...MirrorBaseFields
      }
    }
  }
`;
```

è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ç¡®å®æ·»åŠ äº†ä¸€ä¸ªæ–°çš„æŸ¥è¯¢è¾“å…¥å‚æ•°ï¼š$publicationsRequestã€‚PublicationsQueryRequestï¼ã€‚è¿™æ˜¯æˆ‘ä»¬å¿…é¡»ç¡®ä¿åœ¨å¯åŠ¨æŸ¥è¯¢æ—¶ä½œä¸ºè¾“å…¥å‚æ•°ä¼ å…¥çš„ä¸œè¥¿ã€‚

#### 2. æ›´æ–°ä¸ªäººèµ„æ–™é¡µé¢ï¼Œä»¥ä½¿ç”¨æ–°çš„GraphQLæŸ¥è¯¢ã€‚

åœ¨ç®€ä»‹é¡µä¸Šï¼Œè¿™ä¸€æ­¥æˆ‘ä»¬çœŸæ­£éœ€è¦åšçš„äº‹æƒ…æ˜¯ä¸ºæˆ‘ä»¬æƒ³è¦çš„å¸–å­æ·»åŠ å‘å¸ƒè¯·æ±‚ã€‚è¯¥è¯·æ±‚æœ¬èº«åº”è¯¥æ˜¯è¿™æ ·çš„ã€‚

```javascript
publicationsRequest: {
  profileId: id,
  publicationTypes: ["POST"], // We really only want POSTs
},
```

å› æ­¤ï¼Œè®©æˆ‘ä»¬æŠŠå®ƒæ·»åŠ åˆ°useQueryè¾“å…¥å‚æ•°é€‰é¡¹ä¸­ã€‚

```javascript
// pages/profile/[id].js

import { useQuery, useMutation } from "@apollo/client";
import { useRouter } from "next/router";
import fetchProfileQuery from "../../queries/fetchProfileQuery.js";
import Profile from "../../components/Profile.js";

export default function ProfilePage() {
  const router = useRouter();
  const { id } = router.query;

  console.log("fetching profile for", id);
  const { loading, error, data } = useQuery(fetchProfileQuery, {
    variables: {
      request: { profileId: id },
      publicationsRequest: {
        profileId: id,
        publicationTypes: ["POST"], // We really only want POSTs
      },
    },
  });

  if (loading) return "Loading..";
  if (error) return `Error! ${error.message}`;

  console.log("on profile page data: ", data);
  return (
    <div className="flex flex-col p-8 items-center">
      <Profile profile={data.profile} displayFullProfile={true} />
    </div>
  );
}
```

#### 3. ä¸º "å¸–å­ "åˆ›å»ºä¸€ä¸ªæ–°çš„ç»„ä»¶å®šä¹‰ã€‚

æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–°çš„Reactç»„ä»¶æ¥æ˜¾ç¤ºæ£€ç´¢åˆ°çš„å…³äºç”¨æˆ·å¸–å­çš„æ•°æ®ã€‚è®©æˆ‘ä»¬åœ¨ components/Post.js ä¸­åˆ›å»ºä¸€ä¸ªã€‚

```javascript
// components/Post.js
export default function Post(props) {
  const post = props.post;

  return (
    <div className="p-8">
      <div className="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl">
        <div className="md:flex">
          <div className="p-8">
            <p className="mt-2 text-xs text-slate-500 whitespace-pre-line">
              {post.metadata.content}
            </p>
          </div>
        </div>
      </div>
    </div>
  );
}
```

å¦‚æœä½ æŠŠè¿™ä¸ªç®€å•çš„ç»„ä»¶å’ŒProfileç»„ä»¶è¿›è¡Œæ¯”è¾ƒï¼Œä½ ä¼šå‘ç°å®ƒä»¬éƒ½éµå¾ªä¸€ä¸ªéå¸¸ç®€å•çš„æ¨¡å¼ï¼Œé‚£å°±æ˜¯å®ƒä»¬æ¥å—ä¸€ä¸ªpropså¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æœ‰ç»„ä»¶æ‰€éœ€è¦çš„æ•°æ®ï¼Œä»¥å‘ˆç°å®ƒçš„æŸäº›éƒ¨åˆ†ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çœŸæ­£éœ€è¦çš„åªæ˜¯æ¥è‡ªå¸–å­çš„ä¸€ä¸ªæ ¸å¿ƒä¿¡æ¯ã€‚

- `post.metadata.content`

é‰´äºè¿™ä¸ªå…ƒæ•°æ®å­—æ®µæ˜¯æˆ‘ä»¬å”¯ä¸€éœ€è¦çš„ï¼Œä½ å®é™…ä¸Šå¯ä»¥åœ¨ä»¥åå›åˆ°GraphQLæ–‡æ¡£ä¸­ï¼Œåˆ é™¤æˆ‘ä»¬åœ¨æœ€ç»ˆåŠŸèƒ½ä¸­æ²¡æœ‰ä½¿ç”¨çš„å­—æ®µã€‚

è¿™ä¸ªç»„ä»¶ä¹Ÿä½¿ç”¨Tailwindçš„CSSè¿›è¡Œæ ·å¼è®¾è®¡ã€‚

#### 4. å°†ä»Lens APIè¿”å›çš„æ•°æ®ä¼ é€’åˆ°æ–°çš„ç»„ä»¶ä¸­

å›åˆ°ä¸ªäººèµ„æ–™é¡µé¢ï¼ˆpages/profile/[id].jsï¼‰ã€‚

ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†<Post/>ç»„ä»¶å¯¼å…¥åˆ°ä¸ªäººèµ„æ–™é¡µé¢ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥å‘ˆç°æˆ‘ä»¬ä»APIè¿”å›çš„æ‰€æœ‰å¸–å­ã€‚

```javascript
import { useQuery, useMutation } from "@apollo/client";
import { useRouter } from "next/router";
import fetchProfileQuery from "../../queries/fetchProfileQuery.js";
import Profile from "../../components/Profile.js";
import Post from "../../components/Post.js";

export default function ProfilePage() {
  const router = useRouter();
  const { id } = router.query;

  console.log("fetching profile for", id);
  const { loading, error, data } = useQuery(fetchProfileQuery, {
    variables: {
      request: { profileId: id },
      publicationsRequest: {
        profileId: id,
        publicationTypes: ["POST"],
      },
    },
  });

  if (loading) return "Loading..";
  if (error) return `Error! ${error.message}`;

  return (
    <div className="flex flex-col p-8 items-center">
      <Profile profile={data.profile} displayFullProfile={true} />
      {data.publications.items.map((post, idx) => {
        return <Post key={idx} post={post}/>;
      })}
    </div>
  );
}
```

è¯·æ³¨æ„ï¼Œåœ¨è¯¥ä»£ç æ®µçš„åº•éƒ¨ï¼Œå®é™…ä¸Šæ˜¯è¿™å‡ è¡Œä»£ç ã€‚

```javascript
      {data.publications.items.map((post, idx) => {
        return <Post key={idx} post={post}}/>;
      })}
```

åœ¨è¿™ä¸€æ­¥éª¤ä¸­åšäº†å¤§é‡çš„å·¥ä½œã€‚ä½†åœ¨æ·»åŠ äº†å®ƒä¹‹åï¼Œæˆ‘ä»¬åº”è¯¥å¯ä»¥å°è¯•ä¸€ä¸‹æˆ‘ä»¬çš„å¸–å­åŠŸèƒ½äº†ã€‚

#### 5. æµ‹è¯•å’Œè°ƒè¯•

å¦‚æœä¸€åˆ‡é¡ºåˆ©çš„è¯ï¼Œä½ ç°åœ¨åº”è¯¥å¯ä»¥çœ‹åˆ°åœ¨ä¸ªäººèµ„æ–™å¡ä¸‹çš„å¸–å­äº†

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/20220831222539.png)


æ­å–œä½ ï¼Œä½ å·²ç»åœ¨æˆä¸ºä¸€ä¸ªå»ä¸­å¿ƒåŒ–çš„ç¤¾äº¤åª’ä½“å¼€å‘è€…çš„è·¯ä¸Šäº† :)

### å…¶ä»–APIå’Œèµ„æº

å¸Œæœ›åˆ°æ­¤ä¸ºæ­¢ï¼Œä½ å·²ç»å®Œæˆäº†å…¶ä»–ä¸€äº›Road To Web3çš„æŒ‘æˆ˜ï¼Œå¹¶ä¸”ä½ å¾ˆäº«å—èµ°åˆ°è¿™ä¸€æ­¥çš„è¿‡ç¨‹ã€‚æœ¬å‘¨çš„è¯¾ç¨‹æ˜¯å…³äºå¦‚ä½•ä½¿ç”¨å»ºç«‹åœ¨NFTså’Œå»ä¸­å¿ƒåŒ–åè®®ä¹‹ä¸Šçš„APIã€‚

æˆ‘å¼ºçƒˆå»ºè®®ä½ æŠ½å‡ºæ—¶é—´æ¥æ¢ç´¢Lensæ–‡æ¡£ï¼Œå°è¯•ä¸åŒçš„ç«¯ç‚¹ï¼Œå¹¶é˜…è¯»è¿™ä¸ª repoä¸­æ‰˜ç®¡çš„ç¤ºä¾‹ä»£ç ã€‚

[https://github.com/aave/lens-api-examples](https://github.com/aave/lens-api-examples)

è¿™é‡Œæœ‰ä¸€äº›å…¶ä»–å‰æ²¿çš„web3 apisã€‚

- [MintKudos PoK Tokens APIs ](https://contributionlabs.notion.site/Public-APIs-054cc0a8110a45a9be326fda382bb6bc#6e2810e0d8984496ad7a8674adf12dfd)- ç”±Kei @ Contribution Labsåˆ›å»ºã€‚
- [Lit Protocol SDKå’Œæ•™ç¨‹](https://litprotocol.notion.site/Decentralized-Unlockable-Content-21a2a1dadb4a4845a5a77ab2589069a0)--ç”±Deb @ Lit Protocolåˆ›å»º

æœ‰äº†è¿™äº›å·¥å…·å’Œæ•°æ®è®¿é—®æƒï¼Œæˆ‘çœŸçš„å¾ˆæƒ³çœ‹çœ‹ä½ ä»¬éƒ½èƒ½æƒ³å‡ºä»€ä¹ˆåŠæ³•æ¥ ğŸ™‚

ä¸€ä¸ªWeb3ç‘œä¼½ç¤¾äº¤ç½‘ç»œï¼Ÿ

ä»…ä¾›Road to Web3 PoKä»£å¸æŒæœ‰äººä½¿ç”¨çš„ç‹¬å®¶èšä¼šåœºæ‰€ï¼Ÿ

ä¸€ä¸ªæ–°æ—¶ä»£çš„åœ¨çº¿æ•™å®¤ï¼Œæ•™å¸ˆé€šè¿‡ä½ ä»¬çš„dappç›´æ¥ä»å­¦ç”Ÿé‚£é‡Œè·å¾—å†…å®¹å’Œæ•™è‚²æ–¹é¢çš„æŠ¥é…¬ï¼Ÿ

è¿™ç§å¯èƒ½æ€§æ˜¯æ— ç©·æ— å°½çš„ã€‚

### æŒ‘æˆ˜

æœ¬å‘¨çš„å†…å®¹å¾ˆå¤æ‚ï¼Œæ‰€ä»¥æˆ‘ç»™ä½ çš„æŒ‘æˆ˜é€‰é¡¹æ˜¯æ•…æ„æ¨¡ç³Šçš„ï¼Œä»¥ä¾¿ä½ å¯ä»¥éšæ„æ¢ç´¢ã€‚è‡³å°‘ä»ä¸‹é¢çš„é€‰é¡¹ä¸­é€‰ä¸€ä¸ªï¼Œçœ‹çœ‹ä½ èƒ½åšåˆ°ä»€ä¹ˆç¨‹åº¦ã€‚

1. ä½¿ç”¨Lens APIï¼ŒæŸ¥è¯¢æ•™ç¨‹ä¸­æœªæ¶‰åŠçš„æ–°ä¿¡æ¯ï¼Œå¹¶åœ¨ç½‘ç«™ä¸Šæ˜¾ç¤ºã€‚
2. ä½¿ç”¨Lens APIï¼Œå¼„æ¸…æ¥šå¦‚ä½•å¯¹ååº”ã€å…³æ³¨æˆ–åˆ›å»ºæ–°å‡ºç‰ˆç‰©ç­‰è¡Œä¸ºè¿›è¡Œè®¤è¯å’Œçªå˜ã€‚
3. ä½¿ç”¨Repl.itæˆ–Vercelç­‰æœåŠ¡ï¼Œå°†ä½ çš„åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°å…¨çƒç½‘ç»œä¸Šã€‚
4. ä½¿ç”¨Litåè®®SDKå¯¹ä½ çš„Lensåè®®å¸–å­è¿›è¡Œä»¤ç‰Œè®¿é—®ï¼Œè¿™æ ·åªæœ‰MintKudosçš„ä»¤ç‰ŒæŒæœ‰è€…æ‰èƒ½æŸ¥çœ‹å®ƒä»¬ã€‚

ä½ å·²ç»æˆåŠŸåœ°å­¦ä¼šäº†å¦‚ä½•ä½¿ç”¨Lensåè®®è¿›è¡Œå¯¼èˆªã€æŸ¥è¯¢å’Œæ„å»º! ğŸ”¥

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/my.png)