---
title: Web3æ•™ç¨‹ï¼šç¼–å†™æ‚¨çš„ç¬¬ä¸€ä¸ªâ€œHello, Worldâ€æ™ºèƒ½åˆçº¦ï¼ˆ3ï¼‰
description: null
author: æç•™ç™½
weight: 0
date: 2022-10-30T01:08:56.618Z
lastmod: 2022-10-30T01:25:33.763Z
tags: []
categories:
  - åŒºå—é“¾
  - WEB3.0
featuredImage: https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/202210271827013.png
---

ä¸Šä¸€ç¯‡ä¼ é€é—¨ï¼š[Web3æ•™ç¨‹ï¼šç¼–å†™æ‚¨çš„ç¬¬ä¸€ä¸ªâ€œHello, Worldâ€æ™ºèƒ½åˆçº¦ï¼ˆ2ï¼‰](https://mp.weixin.qq.com/s/ZPojn5PjZZ8WUBvUxCAWbw)

## ç›®å½•

1. ä»€ä¹ˆæ˜¯æ™ºèƒ½åˆçº¦
2. éƒ¨ç½²æ‚¨çš„ç¬¬ä¸€ä¸ªæ™ºèƒ½åˆçº¦
3. ä»€ä¹ˆæ˜¯æ°”ä½“
4. ä¸æ‚¨çš„æ™ºèƒ½åˆçº¦äº¤äº’
5. æ™ºèƒ½åˆçº¦çš„ç»“æ„
6. å°†æ‚¨çš„åˆåŒæäº¤ç»™ Etherscan
7. æ™ºèƒ½åˆçº¦å®‰å…¨æŒ‘æˆ˜
8. å°†åˆçº¦é›†æˆåˆ°å‰ç«¯
9. å…¶ä»–èµ„æº

## 6ã€å°†æ‚¨çš„æ™ºèƒ½åˆçº¦æäº¤ç»™ Etherscan

æ‚¨ä¸ºå®ç°æ™ºèƒ½åˆçº¦æ‰€åšçš„æ‰€æœ‰è‰°è‹¦å·¥ä½œå®Œæˆäº† - ç°åœ¨æ˜¯æ—¶å€™ä¸ä¸–ç•Œåˆ†äº«å®ƒäº†ï¼

é€šè¿‡åœ¨ Etherscan ä¸ŠéªŒè¯æ‚¨çš„æ™ºèƒ½åˆçº¦ï¼Œä»»ä½•äººéƒ½å¯ä»¥æŸ¥çœ‹æ‚¨çš„æºä»£ç å¹¶ä¸æ‚¨çš„æ™ºèƒ½åˆçº¦è¿›è¡Œäº¤äº’ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ï¼

### ç¬¬ 1 æ­¥ï¼šåœ¨æ‚¨çš„ Etherscan å¸æˆ·ä¸Šç”Ÿæˆ API å¯†é’¥

éœ€è¦ Etherscan API å¯†é’¥æ¥éªŒè¯æ‚¨æ˜¯æ‚¨å°è¯•å‘å¸ƒçš„æ™ºèƒ½åˆçº¦çš„æ‰€æœ‰è€…ã€‚

> å¦‚æœæ‚¨æ²¡æœ‰ Etherscan å¸æˆ·ï¼Œè¯·å…ˆä½¿ç”¨æ­¤[é“¾æ¥](https://etherscan.io/register)æ³¨å†Œã€‚

ç™»å½•åï¼ŒæŒ‰å³ä¸Šè§’çš„ç”¨æˆ·åï¼Œç„¶åé€‰æ‹©â€œæˆ‘çš„ä¸ªäººèµ„æ–™â€æŒ‰é’®ï¼š

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/202210300914842.png)

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/202210300915228.png)

å®Œæˆä¸Šè¿°æ­¥éª¤åï¼Œæ‚¨åº”è¯¥èƒ½å¤ŸæŸ¥çœ‹æ–°çš„ API å¯†é’¥ï¼Œæˆ‘ä»¬åœ¨ä¸‹é¢ä»¥çº¢è‰²çªå‡ºæ˜¾ç¤ºã€‚å°†æ­¤ API å¯†é’¥å¤åˆ¶åˆ°å‰ªè´´æ¿ã€‚

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/202210300915540.png)

### ç¬¬ 2 æ­¥ï¼šHardhatéƒ¨ç½²çš„æ™ºèƒ½åˆçº¦

#### æ­¥éª¤ 2.1 å®‰è£…[hardhat-etherscan](https://hardhat.org/plugins/nomiclabs-hardhat-etherscan.html)æ’ä»¶

åœ¨ä½ çš„ hello-world ç›®å½•ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å®‰è£… `hardhat-etherscan`ï¼š

```
npm install --save-dev @nomiclabs/hardhat-etherscan
```

ä½¿ç”¨ hardhat-etherscan ä¿¡æ¯ä¿®æ”¹æ‚¨çš„ hardhat.config.jsï¼Œç¡®ä¿è¾“å…¥æ‚¨çš„ etherscan api å¯†é’¥ï¼š

```js
/**
* @type import('hardhat/config').HardhatUserConfig
*/

require('dotenv').config();
require("@nomiclabs/hardhat-ethers");
require("@nomiclabs/hardhat-etherscan");

const { API_URL, PRIVATE_KEY } = process.env;

module.exports = {
   solidity: "0.7.3",
   defaultNetwork: "goerli",
   networks: {
      hardhat: {},
      goerli: {
         url: API_URL,
         accounts: [`0x${PRIVATE_KEY}`]
      }
   },
   etherscan: {
    // Your API key for Etherscan
    // Obtain one at https://etherscan.io/
    apiKey: "YOUR_ETHERSCAN_API_KEY" //
   }
};
```

#### æ­¥éª¤ 2.2 åœ¨ Etherscan ä¸ŠéªŒè¯æ‚¨çš„æ™ºèƒ½åˆçº¦ï¼

åœ¨ hello-world ç›®å½•ä¸­ï¼Œåœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```
npx hardhat verify --network goerli DEPLOYED_CONTRACT_ADDRESS "Hello World!"
```

> ç¡®ä¿ DEPLOYED_CONTRACT_ADDRESS æ˜¯æ‚¨åœ¨ goerli æµ‹è¯•ç½‘ç»œä¸Šéƒ¨ç½²çš„æ™ºèƒ½åˆçº¦çš„åœ°å€ã€‚æ­¤å¤–ï¼Œæœ€åä¸€ä¸ªå‚æ•°â€œHello Worldï¼â€ å¿…é¡»ä¸æ‚¨åœ¨ç¬¬ 1 éƒ¨åˆ†çš„éƒ¨ç½²æ­¥éª¤ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²å€¼ç›¸åŒã€‚

å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ‚¨åº”è¯¥ä¼šåœ¨ç»ˆç«¯ä¸­çœ‹åˆ°ä»¥ä¸‹æ¶ˆæ¯ï¼š

Congrats! Your smart contract code should be on Etherscan!

### ç¬¬ 3æ­¥ï¼šåœ¨ Etherscan ä¸ŠæŸ¥çœ‹æ‚¨çš„æ™ºèƒ½åˆçº¦ï¼

å½“æ‚¨å¯¼èˆªåˆ°ç»ˆç«¯ä¸­æä¾›çš„é“¾æ¥æ—¶ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿçœ‹åˆ°æ‚¨çš„æ™ºèƒ½åˆçº¦ä»£ç å’Œ ABI åœ¨ Etherscan ä¸Šå‘å¸ƒï¼

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/202210300918907.png)

å“‡â€”â€”ä½ å®Œæˆäº†ï¼Œå† å†›ï¼ç°åœ¨ä»»ä½•äººéƒ½å¯ä»¥callæˆ–writeç»™ä½ çš„æ™ºèƒ½åˆçº¦ï¼æˆ‘ä»¬è¿«ä¸åŠå¾…åœ°æƒ³çœ‹çœ‹ä½ æ¥ä¸‹æ¥è¦å»ºé€ ä»€ä¹ˆï¼ğŸ‰

# 7ã€æ™ºèƒ½åˆçº¦å®‰å…¨æŒ‘æˆ˜

ä¸æ›´ä¼ ç»Ÿçš„ç¼–ç¨‹è¯­è¨€çš„å¤§å¤šæ•°ç”¨ä¾‹ä¸åŒï¼ŒSolidity åˆçº¦å€¾å‘äºè½¬ç§»å¤§é‡èµ„é‡‘ä½œä¸ºå…¶æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œå› æ­¤å®¹æ˜“å—åˆ°æ”»å‡»è€…çš„å„ç§é«˜é£é™©æ”»å‡»ï¼Œè¿™äº›æ”»å‡»è€…è¯•å›¾ä»è¿™äº›ä¸å¯å˜çš„å‚ä¸è€…èº«ä¸Šæ¦¨å–èµ„é‡‘. 

å› æ­¤ï¼Œå¼ºçƒˆå»ºè®®å¼€å‘äººå‘˜åœ¨å‘ä¸»ç½‘å‘å¸ƒæ™ºèƒ½åˆçº¦ä¹‹å‰è¿›è¡Œå®¡è®¡æˆ–è˜è¯·å®¡è®¡æœºæ„â€”â€”ä¸€æ—¦å‘å¸ƒï¼Œå°±å¾ˆéš¾è¿½æº¯ä¿®å¤å®‰å…¨æ¼æ´ï¼

æ½œåœ¨æ¼æ´çš„ç±»å‹ä»¥åŠæ‰§è¡Œè¿™äº›æ”»å‡»çš„æ–¹å¼æœ¬èº«å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¿‡ç¨‹ã€‚è®©æˆ‘ä»¬å¿«é€Ÿæ¦‚è¿°ä¸€ä¸‹ä¸»è¦æ¼æ´ï¼Œä»¥ä¾¿æ‚¨äº†è§£éœ€è¦æ³¨æ„çš„äº‹é¡¹ï¼š 

### Reentrancy Attacks

è¿™ç§ç±»å‹çš„æ”»å‡»éå¸¸å±é™©ï¼Œå¯ä»¥è®©æ˜“å—æ”»å‡»çš„æ™ºèƒ½åˆçº¦è€—å°½æ‰€æœ‰çš„ä»¥å¤ªå¸ï¼Œå¹¶ä¸”éå¸¸å®¹æ˜“æ„å¤–æäº¤ã€‚é‡å…¥æ”»å‡»çš„å‘ç”Ÿæ˜¯å› ä¸º Solidity çš„ä¸¤ä¸ªå…³é”®ç‰¹æ€§ï¼š 

1. æ™ºèƒ½åˆçº¦å¼ºåˆ¶æ‰§è¡Œâ€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬åœ¨æ‰§è¡Œä¸‹ä¸€è¡Œä¹‹å‰ç­‰å¾…æ¯ä¸€è¡Œå®Œæˆã€‚
2. æ™ºèƒ½åˆçº¦å¯ä»¥è°ƒç”¨å¤–éƒ¨çš„ã€ä¸å—ä¿¡ä»»çš„åˆçº¦å¹¶åœ¨ç»§ç»­ä¹‹å‰ç­‰å¾…ç»“æœã€‚

å› æ­¤ï¼Œå½“ä¸€ä¸ªæ˜“å—æ”»å‡»çš„åˆçº¦ A å¯¹å¦ä¸€ä¸ªä¸å—ä¿¡ä»»çš„åˆçº¦ B è¿›è¡Œå¤–éƒ¨è°ƒç”¨æ—¶ï¼Œå¦ä¸€ä¸ªåˆçº¦ B å¯èƒ½è¢«æ¶æ„æ›´æ”¹ä¸ºå¯¹åŸå§‹åˆçº¦ A è¿›è¡Œé€’å½’è°ƒç”¨ã€‚å¦‚æœä»åˆçº¦ A åˆ° B çš„è°ƒç”¨æ¶‰åŠå‘é€ä»»ä½•æ•°é‡çš„ä»¥å¤ªå¸ï¼Œè¿™ä¸ªæ— é™å¾ªç¯éƒ½å¯ä»¥åœ¨å‡½æ•°å®Œæˆä¹‹å‰æœ‰æ•ˆåœ°è€—å°½åˆçº¦ A çš„æ‰€æœ‰èµ„æºã€‚

è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š 

```js
contract A {
	function withdraw() external {
  	uint256 amount = balances[msg.sender];
    (bool success, ) = msg.sender.call.value(amount)("");
    require(success);
    balances[msg.sender] = 0;
}}
```

é€šå¸¸ï¼Œ**msg.sender**æ˜¯æ™®é€šç”¨æˆ·ï¼Œä¾‹å¦‚ Metamask å¸æˆ·ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ**withdraw()**å‡½æ•°å°†ç®€å•åœ°æå–ä¸€äº›é’±ï¼Œæ›´æ–°ä½™é¢ï¼Œç„¶åç»“æŸã€‚ä½†æ˜¯ï¼Œå¦‚æœ**msg.sender**æ˜¯æ¶æ„åˆçº¦ Bï¼Œåˆ™å½“åˆçº¦ A è¿è¡Œ**msg.sender.call**æ—¶ï¼Œå¯ä»¥è®¾ç½®åˆçº¦ B ä½¿å…¶ç«‹å³å†æ¬¡è°ƒç”¨åˆçº¦ Aã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°†é‡å¤è°ƒç”¨**withdraw()**å‡½æ•°ï¼Œç›´åˆ°åˆçº¦ A æ²¡æœ‰èµ„æºæˆ– EVM å †æ ˆå¡«æ»¡ã€‚å¾ˆå±é™©ï¼Œå¯¹å§ï¼Ÿ 

æœ‰å…³å¦‚ä½•é˜²æ­¢è¿™ç§æƒ…å†µçš„ä¸€äº›ç¤ºä¾‹ï¼Œ[è¯·åœ¨æ­¤å¤„æŸ¥çœ‹æœ¬æ–‡ã€‚](https://medium.com/coinmonks/protect-your-solidity-smart-contracts-from-reentrancy-attacks-9972c3af7c21)

### Frontrunning

æœ‰è¶£çš„æ˜¯ï¼Œæ™ºèƒ½åˆçº¦å’Œäº¤æ˜“ä¸æ˜¯åœ¨åŒºå—é“¾ä¸Šå¾—åˆ°ç¡®è®¤æ—¶æ‰å®Œå…¨å…¬å¼€ï¼Œè€Œæ˜¯åœ¨æ‚¨å°†å®ƒä»¬ä½œä¸ºå¾…å¤„ç†äº¤æ˜“æäº¤åˆ°ç½‘ç»œæ—¶ã€‚è¿™äº›å¾…å¤„ç†çš„äº¤æ˜“åœ¨ä»¥å¤ªåŠèŠ‚ç‚¹çš„å†…å­˜æ± ä¸­åœ¨æ•´ä¸ªç½‘ç»œä¸­å…±äº«ï¼Œå…è®¸ä¸€ä¸ªåŒºå—çš„çŸ¿å·¥é€‰æ‹©å…·æœ‰æœ€é«˜ Gas è´¹çš„äº¤æ˜“ã€‚ 

è¿™ç§è®¾è®¡çš„ä¸€ä¸ªå‰¯ä½œç”¨æ˜¯æ™ºèƒ½åˆçº¦çš„é¢„æœŸç»“æœåœ¨è¢«ç¡®è®¤è¿›å…¥åŒºå—é“¾ä¹‹å‰çš„ä¸€æ®µæ—¶é—´å†…å¯¹æ‰€æœ‰äººéƒ½æ˜¯å¯è§çš„ã€‚å‡è®¾æ‚¨æœ‰ä¸€ä¸ªæ™ºèƒ½åˆçº¦ï¼Œåœ¨è¿è¡Œæ—¶å°†æ‰§è¡Œä¸€ä¸ªå¥—åˆ©ï¼Œä¸ºæ‚¨èµšå– 1 ETHï¼Œéƒ¨ç½²æˆæœ¬ä¸º 0.05 ETHã€‚ç›‘è§†å†…å­˜æ± çš„æ¶æ„è¡Œä¸ºè€…å¯èƒ½ä¼šçœ‹åˆ°æ­¤äº¤æ˜“ï¼Œè¯†åˆ«æœºä¼šå¹¶å¤åˆ¶æ‚¨çš„æ™ºèƒ½åˆçº¦ï¼Œå¹¶ä»¥ 0.06 ETH çš„æ±½æ²¹è´¹æäº¤ã€‚ç„¶åï¼Œä»–ä»¬æˆåŠŸåœ°â€œæŠ¢å…ˆâ€ä½ çš„åˆçº¦ï¼Œé€šè¿‡å…ˆæäº¤ä»–ä»¬çš„äº¤æ˜“çªƒå–ä½ çš„å¥—åˆ©æœºä¼šã€‚

åœ¨å®è·µä¸­ï¼Œè¿™äº›æ”»å‡»é€šå¸¸æ˜¯ç”±çŸ¿å·¥è‡ªå·±è¿›è¡Œçš„ï¼Œå¯¼è‡´ä¸€ç§ç§°ä¸º MEVï¼ˆçŸ¿å·¥å¯æå–ä»·å€¼ï¼‰çš„ç°è±¡ï¼Œæ¯å¤©ä»·å€¼æ•°åƒ ETHã€‚ä¸å¹¸çš„æ˜¯ï¼Œå®ƒä»¬å¾ˆéš¾é¿å…ï¼Œä½†[æœ¬æ–‡æè¿°äº†å„ç§å‰æ²¿å®è·µã€‚ ](https://forum.openzeppelin.com/t/protecting-against-front-running-and-transaction-reordering/1314)

### Integer Overflow & Underflow

è¿™æ˜¯è®¸å¤šç¼–ç¨‹è¯­è¨€ä¸­çš„å¸¸è§æ”»å‡»ï¼ä»¥ä¸‹æ˜¯æ­¤ç±»æ”»å‡»åœ¨ Solidity ä¸­å¦‚ä½•å‘ç”Ÿçš„ä¸€èˆ¬è¦ç‚¹ï¼š

1. Solidity æ™ºèƒ½åˆçº¦ä½¿ç”¨ 256 ä½ä½œä¸ºå­—é•¿æ„å»ºï¼Œå¤§çº¦ç›¸å½“äº 43 äº¿ã€‚ 
2. å½“å‡å°‘æ— ç¬¦å·æ•´æ•°0çš„å€¼æ—¶ï¼Œå®ƒå°†å¾ªç¯å›åˆ°æœ€å¤§å€¼ã€‚
3. å› æ­¤ï¼Œå¯ä»¥é€šè¿‡è®©æ™ºèƒ½åˆçº¦è®°å½•çš„æ¶æ„åœ°å€é›¶ä½™é¢å°è¯•å‘é€ 1 ä¸ªå•ä½çš„ä»¥å¤ªå¸æ¥æ‰§è¡Œä¸‹æº¢æ”»å‡»ï¼Œè¿«ä½¿å…¶ä½™é¢ä¸€ç›´å¾ªç¯å›åˆ°å…è®¸çš„æœ€å¤§å€¼ï¼š43 äº¿ã€‚ 
4. ç„¶åï¼Œå› ä¸ºæ™ºèƒ½åˆçº¦è®¤ä¸ºè¯¥åœ°å€æœ‰ 43 äº¿ä»¥å¤ªå¸çš„ä½™é¢ï¼Œå®ƒå¯èƒ½å…è®¸ä»è¯¥è´¦æˆ·ç»§ç»­ææ¬¾ï¼Œç›´åˆ°æ™ºèƒ½åˆçº¦çš„èµ„é‡‘è€—å°½ã€‚

å¦‚æ‚¨æ‰€è§ï¼Œè¿™ç§é»‘å®¢æ”»å‡»å¾ˆå®¹æ˜“è¢«ç”¨äºå†…éƒ¨è·Ÿè¸ªåœ°å€ä½™é¢çš„ä»»ä½•æ™ºèƒ½åˆçº¦ã€‚ä¸ºé¿å…è¿™ç§æƒ…å†µï¼Œåªéœ€ç¡®ä¿æ‚¨ä½¿ç”¨çš„æ˜¯ 0.8 ç‰ˆæœ¬çš„ Solidity ç¼–è¯‘å™¨ï¼Œå®ƒä¼šè‡ªåŠ¨æ£€æŸ¥ä¸Šæº¢å’Œä¸‹æº¢ã€‚ 

### å¤©å“ªâ€¦â€¦è¿˜æœ‰ä»€ä¹ˆï¼Ÿ 

ä¸å¹¸çš„æ˜¯ï¼Œè¿˜æœ‰å‡ åä¸ªå…¶ä»–é‡å¤§æ¼æ´ã€‚æ­£å¦‚è®¸å¤šå¼€å‘äººå‘˜æ‰€è¯´ï¼Œâ€œå­¦ä¹  Solidity éœ€è¦ä¸€å‘¨æ—¶é—´ï¼Œé¿å…ç¼–å†™æ¼æ´éœ€è¦ä¸‰å¹´æ—¶é—´â€ã€‚ 

è®¤è¯†åˆ°åœ¨ä½ ç¼–å†™çš„ä»»ä½•ä¸­ç­‰å¤æ‚çš„æ™ºèƒ½åˆçº¦ä¸­å¾ˆå¯èƒ½æœ€ç»ˆä¼šé‡åˆ°å®‰å…¨é—®é¢˜å°±è¶³å¤Ÿäº†ï¼Œå¦‚æœä½ æ‰“ç®—åœ¨åˆçº¦ä¸­å­˜å‚¨ä»»ä½•é‡è¦çš„ä»·å€¼ï¼Œä½ ç»å¯¹åº”è¯¥è®©ä¸“ä¸šäººå£«å¯¹ä»£ç è¿›è¡Œå®¡è®¡æœºæ„ã€‚ 

> è¯‘è€…æ³¨ï¼šä¸‹ä¸€ç¯‡æ˜å¤©åˆ°æ¥ï¼Œä¿æŒå…³æ³¨ã€‚

![](https://hicoldcat.oss-cn-hangzhou.aliyuncs.com/img/my.png)